"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[5042],{5042:(M,P,l)=>{l.r(P),l.d(P,{ConfirmOrderPageModule:()=>Ct});var s=l(6895),f=l(4006),h=l(8008),m=l(3416),_=l(5433),A=l(8854),c=l(8634),d=l(9116),i=l(1782),y=l(655),R=l(5762),T=l(7102),t=l(4650),I=l(6339);let q=(()=>{class r extends R.H{constructor(e){super(),this.location=e}ngOnInit(){}handleClick(){return(0,y.mG)(this,void 0,void 0,function*(){this.router.navigated?this.location.back():this.router.navigate(["/"],{replaceUrl:!0})})}}return r.\u0275fac=function(e){return new(e||r)(t.Y36(s.Ye))},r.\u0275cmp=t.Xpm({type:r,selectors:[["app-top-back-button"]],features:[t.qOj],decls:2,vars:0,consts:[[1,"cursor-pointer","w-8","h-8",3,"click"],["name","chevron-back-outline",1,"w-8","h-8"]],template:function(e,n){1&e&&(t.TgZ(0,"div",0),t.NdJ("click",function(){return n.handleClick()}),t._UZ(1,"ion-icon",1),t.qZA())},dependencies:[h.gu]}),r})();var S=(()=>{return(r=S||(S={})).BALANCE="BALANCE",r.CRYPTO="CRYPTO",r.CARD="CARD",S;var r})(),b=(()=>{return(r=b||(b={})).STRIPE="STRIPE",r.TRIPLE="TRIPLE",b;var r})(),g=(()=>{return(r=g||(g={}))[r.BALANCE=1]="BALANCE",r[r.CRYPTO=2]="CRYPTO",r[r.CARD=3]="CARD",g;var r})(),O=(()=>{return(r=O||(O={})).client="client",r.url="url",O;var r})(),C=(()=>{return(r=C||(C={}))[r.BALANCE=1]="BALANCE",r[r.GIFTCODE=2]="GIFTCODE",r[r.STRAGY=3]="STRAGY",C;var r})(),p=l(2340),v=l(4004),Z=l(529),U=l(5939);let L=(()=>{class r{constructor(e,n){this.http=e,this.userService=n}QueryByBusiness(e,n){return this.http.get(`${p.N.BASE_URL}/payment/QueryByBusiness?businessType=${e}&businessId=${n}`)}cancel(e){return this.http.post(`${p.N.BASE_URL}/payment/cancel`,e)}queryPlatformList(){return this.http.get(`${p.N.BASE_URL}/payment/queryPlatformList`)}queryPaymentOrder(e){return this.http.get(`${p.N.BASE_URL}/payment/queryPaymentOrder?id=${e}`)}getShippingFee(e,n,o){return this.http.get(`${p.N.BASE_URL}/shop/product/getFreight`,{params:{receiverId:e,skuId:n,quantity:o}})}getAreaCanBuy(e,n,o){return this.http.get(`${p.N.BASE_URL}/shop/product/getDeliverable`,{params:{receiverId:e,skuId:n,quantity:o}})}getAreaData(e){return this.http.get(`${p.N.BASE_URL}/user/receiver/getAreaData`,{params:{parentId:e||""}})}saveAddress(e){return this.http.post(`${p.N.BASE_URL}/user/receiver/updateReceiverAddress`,e)}createNewAddress(e){return this.http.post(`${p.N.BASE_URL}/user/receiver/saveReceiverAddress`,e)}getOrderSum(e){return this.http.post(`${p.N.BASE_URL}/user/order/getOrderAmount`,e).pipe((0,v.U)(({data:n})=>({originalPrice:parseFloat(n.originalPrice),toTalTQC:parseFloat(n.toTalTQC),totalSumDiscount:parseFloat(n.totalSumDiscount),totalSumFreight:parseFloat(n.totalSumFreight),totalSumPoint:parseFloat(n.totalSumPoint),totalSumPrice:parseFloat(n.totalSumPrice),totalSumQuantity:n.totalSumQuantity})))}getExpress(e,n){return this.http.get(`${p.N.BASE_URL}/user/order/getExpress?orderId=${e}&expressNum=${n}`).pipe((0,v.U)(o=>o.data))}lockOrder(e){return this.http.post(`${p.N.BASE_URL}/user/order/lockOrder`,e)}queryLockOrder(e){return this.http.get(`${p.N.BASE_URL}/user/order/queryLockOrder?sn=${e}`)}submitLockOrder(e){return this.http.post(`${p.N.BASE_URL}/user/order/submitLockOrder`,e)}querySubmitOrder(e){return this.http.get(`${p.N.BASE_URL}/user/order/querySubmitOrder?sn=${e}`)}productToOrder(e){return this.http.post(`${p.N.BASE_URL}/user/order/productToOrder`,e)}balancePayment(e){return this.http.post(`${p.N.BASE_URL}/user/order/balancePayment`,e)}queryExchangeCodeAmount(e){return this.http.get(`${p.N.BASE_URL}/user/order/queryExchangeCodeAmount?code=${e}`).pipe((0,v.U)(n=>n.data))}exchangeCode(e){return this.http.post(`${p.N.BASE_URL}/user/order/exchangeCode`,e)}}return r.\u0275fac=function(e){return new(e||r)(t.LFG(Z.eN),t.LFG(U.K))},r.\u0275prov=t.Yz7({token:r,factory:r.\u0275fac,providedIn:"root"}),r})(),F=(()=>{class r{constructor(e){this.http=e}getRealStrategyPageList(e){return this.http.post(`${p.N.BASE_URL}/strategy/getRealStrategyPageList`,Object.assign({},e)).pipe((0,v.U)(({data:n})=>n))}queryCustomer(e,n){return this.http.get(`${p.N.BASE_URL}/real/queryCustomer?page=${e}&rows=${n}`)}buyStrategy(e){return this.http.post(`${p.N.BASE_URL}/user/buy/strategy`,e)}queryExtension(e){return this.http.get(`${p.N.BASE_URL}/real/queryExtension?realId=${e}`)}getRealSubscriptionLog(e,n,o){return this.http.get(`${p.N.BASE_URL}/strategy/getRealSubscriptionLog?subscriptionId=${o}&page=${e}&rows=${n}`)}getRealDetailById(e){return this.http.get(`${p.N.BASE_URL}/strategy/getRealDetailById`,{params:{realId:e}}).pipe((0,v.U)(({data:n})=>n))}getRealStrategyIndexProfitLine(e){let n=`${p.N.BASE_URL}/strategy/getRealStrategyIndexProfitLine?runId=${e.runId}&type=${e.type}&limit=${e.limit}`;return e.startDate&&(n+=`&startDate=${e.startDate}`),this.http.get(n).pipe((0,v.U)(({data:o})=>o))}getRealTrade(e){return this.http.post(`${p.N.BASE_URL}/strategy/getRealTrade`,Object.assign({},e)).pipe((0,v.U)(({data:n})=>n))}subStrategyReal(e){return this.http.post(`${p.N.BASE_URL}/strategy/subStrategyReal`,Object.assign({},e)).pipe((0,v.U)(({data:n})=>n))}collectStrategyReal(e){return this.http.post(`${p.N.BASE_URL}/strategy/likeStrategyReal`,Object.assign({},e)).pipe((0,v.U)(({data:n})=>n))}}return r.\u0275fac=function(e){return new(e||r)(t.LFG(Z.eN))},r.\u0275prov=t.Yz7({token:r,factory:r.\u0275fac,providedIn:"root"}),r})(),E=(()=>{class r{constructor(e){this.http=e}payV2(e){return this.http.post(`${p.N.BASE_URL}/payment/pay`,e)}}return r.\u0275fac=function(e){return new(e||r)(t.LFG(Z.eN))},r.\u0275prov=t.Yz7({token:r,factory:r.\u0275fac,providedIn:"root"}),r})();function G(r,a){if(1&r){const e=t.EpF();t.TgZ(0,"button",7),t.NdJ("click",function(){const u=t.CHM(e).$implicit,x=t.oxw(2);return t.KtG(x.selectPayWay(u.platformCode))}),t._UZ(1,"img",8),t._uU(2),t.ALo(3,"translate"),t.qZA()}if(2&r){const e=a.$implicit;t.xp6(1),t.Q6J("src",e.icon,t.LSH),t.xp6(1),t.hij(" ",t.lcZ(3,2,e.name)," ")}}function W(r,a){if(1&r&&(t.TgZ(0,"div",3)(1,"div",4),t._uU(2),t.ALo(3,"translate"),t.qZA(),t.TgZ(4,"div",5),t._uU(5),t.ALo(6,"currency"),t.qZA(),t.TgZ(7,"div",4),t._uU(8),t.ALo(9,"translate"),t.qZA(),t.YNc(10,G,4,4,"button",6),t.qZA()),2&r){const e=t.oxw();t.xp6(2),t.hij("",t.lcZ(3,4,"checkout-confirm-amount-to-be-paid"),":"),t.xp6(3),t.Oqu(t.lcZ(6,6,e.amount)),t.xp6(3),t.hij("",t.lcZ(9,8,"checkout-confirm-choose-method"),":"),t.xp6(2),t.Q6J("ngForOf",e.payWayList)}}function D(r,a){1&r&&t._UZ(0,"div",9)}let Y=(()=>{class r{constructor(e,n,o){this.checkoutService=e,this.paymentSrv=n,this.cdRef=o,this.select=new t.vpe,this.paymentPlatform=b.TRIPLE,this.payWayList=[],this.selectedPlatformCode="",this.show=!1,this.loading={createPayOrder:!1,pay:!1},this.getPlayForm()}ngOnInit(){return(0,y.mG)(this,void 0,void 0,function*(){})}getPlayForm(){return(0,y.mG)(this,void 0,void 0,function*(){this.checkoutService.queryPlatformList().pipe().subscribe(e=>(0,y.mG)(this,void 0,void 0,function*(){this.payWayList=null==e?void 0:e.data.filter(n=>Object.is(n.platformGroup,this.paymentPlatform)&&!Object.is(n.platformCode,this.paymentPlatform)),this.cdRef.detectChanges(),this.show=!0,console.log("this.payWayList333",this.payWayList)}))})}selectPayWay(e){this.select.emit(),this.selectedPlatformCode=e}confirm(e,n){console.log(this.selectedPlatformCode,O.client,e,n),this.paymentSrv.payV2({platformCode:this.selectedPlatformCode,paymentType:O.client,businessId:String(e),businessType:n}).pipe().subscribe({next:o=>{this.payResult=o.data,this.loading.createPayOrder=!0,this.loadTriple()},error:o=>{console.error(o)}}).add(()=>{this.loading.createPayOrder=!1})}loadTriple(){console.log(this.payResult);const e=JSON.parse(this.payResult.clientJson);console.log(e),this.cdRef.detectChanges();const n=document.querySelector("#payment-element");this.loading.createPayOrder=!0,console.log(n),n&&(n.innerHTML=`\n    <triplea-ecommerce-payment-v1\n    id="payment"\n    payment-reference="${e.paymentReference}"\n    access-token="${e.accessToken}"\n    lang="zh"\n    ></triplea-ecommerce-payment-v1>\n   `,console.log(n))}}return r.\u0275fac=function(e){return new(e||r)(t.Y36(L),t.Y36(E),t.Y36(t.sBO))},r.\u0275cmp=t.Xpm({type:r,selectors:[["app-payment-methods-crypto"]],inputs:{amount:"amount"},outputs:{select:"select"},decls:4,vars:2,consts:[[1,"payment-methods-crypto"],["class","methods",4,"ngIf","ngIfElse"],["paymentElement",""],[1,"methods"],[1,"title"],[1,"amount-value"],["class","btn-payWay","nz-button","","nzBlock","","nzSize","large",3,"click",4,"ngFor","ngForOf"],["nz-button","","nzBlock","","nzSize","large",1,"btn-payWay",3,"click"],["alt","icon",1,"icon",3,"src"],["id","payment-element",1,"payment-element"]],template:function(e,n){if(1&e&&(t.TgZ(0,"div",0),t.YNc(1,W,11,10,"div",1),t.YNc(2,D,1,0,"ng-template",null,2,t.W1O),t.qZA()),2&e){const o=t.MAs(3);t.xp6(1),t.Q6J("ngIf",!n.payResult&&!n.loading.createPayOrder)("ngIfElse",o)}},dependencies:[s.sg,s.O5,s.H9,m.X$],styles:['.payment-methods-crypto[_ngcontent-%COMP%]   .btn-payWay[_ngcontent-%COMP%]{border-color:#e0e5eb;border-radius:5px;margin-bottom:4px;text-align:left;display:flex;align-items:center;position:relative;border:1px solid #f3f3f3;width:100%;padding:10px 3px}.payment-methods-crypto[_ngcontent-%COMP%]   .btn-payWay[_ngcontent-%COMP%]:after{display:block;content:">";position:absolute;line-height:40px;right:8px;top:0;color:#ccc}.payment-methods-crypto[_ngcontent-%COMP%]   .btn-payWay[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]{height:24px;margin-right:4px}.payment-methods-crypto[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{color:#858a8e;font-size:20px;margin-top:16px}.payment-methods-crypto[_ngcontent-%COMP%]   .amount-value[_ngcontent-%COMP%]{font-weight:700;font-size:24px}.payment-methods-crypto[_ngcontent-%COMP%]   .payment-element[_ngcontent-%COMP%]{margin-top:16px}']}),r})();var J=l(9808),k="https://js.stripe.com/v3",z=/^https:\/\/js\.stripe\.com\/v3\/?(\?.*)?$/,B="loadStripe.setLoadParameters was called but an existing Stripe.js script already exists in the document; existing script parameters will be used",w=null,X=function(a,e,n){if(null===a)return null;var o=a.apply(void 0,e);return function(a,e){!a||!a._registerWrapper||a._registerWrapper({name:"stripe-js",version:"1.54.0",startTime:e})}(o,n),o},N=Promise.resolve().then(function(){return a=null,null!==w||(w=new Promise(function(e,n){if(typeof window>"u"||typeof document>"u")e(null);else if(window.Stripe&&a&&console.warn(B),window.Stripe)e(window.Stripe);else try{var o=function(){for(var a=document.querySelectorAll('script[src^="'.concat(k,'"]')),e=0;e<a.length;e++){var n=a[e];if(z.test(n.src))return n}return null}();o&&a?console.warn(B):o||(o=function(a){var e=a&&!a.advancedFraudSignals?"?advancedFraudSignals=false":"",n=document.createElement("script");n.src="".concat(k).concat(e);var o=document.head||document.body;if(!o)throw new Error("Expected document.body not to be null. Stripe.js requires a <body> element.");return o.appendChild(n),n}(a)),o.addEventListener("load",function(){window.Stripe?e(window.Stripe):n(new Error("Stripe.js not available"))}),o.addEventListener("error",function(){n(new Error("Failed to load Stripe.js"))})}catch(u){return void n(u)}})),w;var a}),$=!1;function tt(r,a){if(1&r){const e=t.EpF();t.TgZ(0,"button",7),t.NdJ("click",function(){const u=t.CHM(e).$implicit,x=t.oxw(2);return t.KtG(x.selectPayWay(u.platformCode))}),t._uU(1),t.ALo(2,"translate"),t._UZ(3,"img",8),t.qZA()}if(2&r){const e=a.$implicit;t.xp6(1),t.hij(" ",t.lcZ(2,2,e.name)," "),t.xp6(2),t.Q6J("src",e.icon,t.LSH)}}function et(r,a){if(1&r&&(t.TgZ(0,"div",3)(1,"div",4),t._uU(2),t.ALo(3,"translate"),t.qZA(),t.TgZ(4,"div",5),t._uU(5),t.ALo(6,"currency"),t.qZA(),t.TgZ(7,"div",4),t._uU(8),t.ALo(9,"translate"),t.qZA(),t.YNc(10,tt,4,4,"button",6),t.qZA()),2&r){const e=t.oxw();t.xp6(2),t.hij("",t.lcZ(3,4,"checkout-confirm-amount-to-be-paid"),":"),t.xp6(3),t.Oqu(t.lcZ(6,6,e.amount)),t.xp6(3),t.hij("",t.lcZ(9,8,"checkout-confirm-choose-method"),":"),t.xp6(2),t.Q6J("ngForOf",e.payWayList)}}function nt(r,a){if(1&r){const e=t.EpF();t._UZ(0,"div",9),t.TgZ(1,"button",10),t.NdJ("click",function(){t.CHM(e);const o=t.oxw();return t.KtG(o.pay())}),t._uU(2),t.ALo(3,"translate"),t.qZA()}2&r&&(t.xp6(2),t.hij(" ",t.lcZ(3,1,"checkout-confirm-pay-now")," "))}N.catch(function(r){$||console.warn(r)});let rt=(()=>{class r{constructor(e,n,o){this.checkoutService=e,this.paymentSrv=n,this.cdRef=o,this.select=new t.vpe,this.paymentPlatform=b.STRIPE,this.payWayList=[],this.selectedPlatformCode="",this.successCallbackUri="",this.loading={createPayOrder:!1,pay:!1}}ngOnInit(){var e;return(0,y.mG)(this,void 0,void 0,function*(){this.payWayList=null===(e=yield(0,J.n)(this.checkoutService.queryPlatformList()))||void 0===e?void 0:e.data.filter(n=>Object.is(n.platformGroup,this.paymentPlatform)&&!Object.is(n.platformCode,this.paymentPlatform)),this.cdRef.detectChanges(),console.log("this.payWayList",this.payWayList)})}selectPayWay(e){this.select.emit(),this.selectedPlatformCode=e}confirm(e,n){console.log(e,this.selectedPlatformCode),this.loading.createPayOrder=!0,this.paymentSrv.payV2({platformCode:this.selectedPlatformCode,paymentType:O.client,businessId:String(e),businessType:n}).pipe().subscribe({next:o=>{this.payResult=o.data,this.loadStripe()},error:o=>{console.error(o)}}).add(()=>{this.loading.createPayOrder=!1})}loadStripe(){return(0,y.mG)(this,void 0,void 0,function*(){try{console.log(this.payResult);const e=JSON.parse(this.payResult.clientJson),{clientSecret:n,pubKey:o,successUri:u}=e,x=yield function(){for(var a=arguments.length,e=new Array(a),n=0;n<a;n++)e[n]=arguments[n];$=!0;var o=Date.now();return N.then(function(u){return X(u,e,o)})}(o),vt={text:"\u7b80\u4f53\u4e2d\u6587",abbr:"\u{1f1e8}\u{1f1f3}",stripe:"zh",tripleA:"zh"};if(this.successCallbackUri=u,!x)return;this.cdRef.detectChanges(),this.stripe=x,this.stripeElements=x.elements({appearance:{theme:"stripe"},locale:vt.stripe,clientSecret:n}),this.loading.createPayOrder=!0,this.stripeElements.create("payment").mount("#payment-element")}catch(e){console.error(e)}})}pay(){return(0,y.mG)(this,void 0,void 0,function*(){this.loading.pay=!0;try{const{error:e}=yield this.stripe.confirmPayment({elements:this.stripeElements,confirmParams:{return_url:this.successCallbackUri}});console.error(e)}catch(e){console.error(e)}finally{this.loading.pay=!1}})}}return r.\u0275fac=function(e){return new(e||r)(t.Y36(L),t.Y36(E),t.Y36(t.sBO))},r.\u0275cmp=t.Xpm({type:r,selectors:[["app-payment-methods-card"]],inputs:{amount:"amount"},outputs:{select:"select"},decls:4,vars:2,consts:[[1,"payment-methods-card"],["class","methods",4,"ngIf","ngIfElse"],["paymentElement",""],[1,"methods"],[1,"title"],[1,"amount-value"],["class","btn-payWay","nz-button","","nzBlock","","nzSize","large",3,"click",4,"ngFor","ngForOf"],["nz-button","","nzBlock","","nzSize","large",1,"btn-payWay",3,"click"],["alt","icon",1,"icon",3,"src"],["id","payment-element"],[1,"btn-pay",3,"click"]],template:function(e,n){if(1&e&&(t.TgZ(0,"div",0),t.YNc(1,et,11,10,"div",1),t.YNc(2,nt,4,3,"ng-template",null,2,t.W1O),t.qZA()),2&e){const o=t.MAs(3);t.xp6(1),t.Q6J("ngIf",!n.payResult&&!n.loading.createPayOrder)("ngIfElse",o)}},dependencies:[s.sg,s.O5,s.H9,m.X$],styles:['.payment-methods-card[_ngcontent-%COMP%]   .btn-payWay[_ngcontent-%COMP%]{border-radius:5px;margin-bottom:4px;text-align:left;display:flex;align-items:center;position:relative;padding:10px 0;border:1px solid #e0e5eb;width:100%}.payment-methods-card[_ngcontent-%COMP%]   .btn-payWay[_ngcontent-%COMP%]:after{display:block;content:">";position:absolute;line-height:40px;right:8px;top:0;color:#ccc}.payment-methods-card[_ngcontent-%COMP%]   .btn-payWay[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]{height:24px;margin-left:12px}.payment-methods-card[_ngcontent-%COMP%]   .btn-pay[_ngcontent-%COMP%]{margin-top:16px;color:#fff;border-color:#fb8811;background:#fb8811;text-shadow:0 -1px 0 rgba(0,0,0,.12);box-shadow:0 2px rgba(0,0,0,.043);width:100%;height:40px;padding:6.4px 15px;font-size:16px;border-radius:5px!important}.payment-methods-card[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{color:#858a8e;font-size:20px;margin-top:16px}.payment-methods-card[_ngcontent-%COMP%]   .amount-value[_ngcontent-%COMP%]{font-weight:700;font-size:24px}']}),r})();const ot=["methodsCard"],at=["methodsCrypto"];function it(r,a){if(1&r){const e=t.EpF();t.O4$(),t.kcU(),t.TgZ(0,"div",11)(1,"div",12)(2,"div",13),t._uU(3),t.ALo(4,"translate"),t.qZA(),t.TgZ(5,"div"),t._uU(6),t.ALo(7,"currency"),t.qZA()(),t._UZ(8,"div",14),t.TgZ(9,"div",15),t._uU(10),t.ALo(11,"translate"),t.qZA(),t.TgZ(12,"button",16),t.NdJ("click",function(){t.CHM(e);const o=t.oxw(2);return o.showPaymentCrypto=!0,t.KtG(o.showPaymentCard=!1)}),t.TgZ(13,"div",17)(14,"div",18),t._uU(15),t.ALo(16,"translate"),t.qZA(),t._UZ(17,"img",19),t.qZA()(),t.TgZ(18,"button",20),t.NdJ("click",function(){t.CHM(e);const o=t.oxw(2);return o.showPaymentCard=!0,t.KtG(o.showPaymentCrypto=!1)}),t.TgZ(19,"div",17)(20,"div",18),t._uU(21),t.ALo(22,"translate"),t.qZA(),t.TgZ(23,"div",21),t._UZ(24,"img",22)(25,"img",23)(26,"img",24),t.qZA()()(),t._UZ(27,"div"),t.qZA()}if(2&r){const e=t.oxw(2);t.xp6(3),t.Oqu(t.lcZ(4,5,"total")),t.xp6(3),t.Oqu(t.lcZ(7,7,e.amount)),t.xp6(4),t.Oqu(t.lcZ(11,9,"checkout-select-payment-methods")),t.xp6(5),t.hij(" ",t.lcZ(16,11,"checkout-payment-methods-crypto")," "),t.xp6(6),t.hij(" ",t.lcZ(22,13,"checkout-payment-methods-card")," ")}}function st(r,a){if(1&r){const e=t.EpF();t.O4$(),t.kcU(),t.TgZ(0,"app-payment-methods-card",25,26),t.NdJ("select",function(){t.CHM(e);const o=t.oxw(2);return t.KtG(o.payWithCard())}),t.qZA()}if(2&r){const e=t.oxw(2);t.Q6J("amount",e.amount)}}function ct(r,a){if(1&r){const e=t.EpF();t.O4$(),t.kcU(),t.TgZ(0,"app-payment-methods-crypto",25,27),t.NdJ("select",function(){t.CHM(e);const o=t.oxw(2);return t.KtG(o.payWithCrypto())}),t.qZA()}if(2&r){const e=t.oxw(2);t.Q6J("amount",e.amount)}}function pt(r,a){if(1&r){const e=t.EpF();t.TgZ(0,"div",3)(1,"div",4),t.GkF(2,5),t._uU(3),t.ALo(4,"translate"),t.qZA(),t.TgZ(5,"button",6),t.NdJ("click",function(){t.CHM(e),t.oxw();const o=t.MAs(1);return t.KtG(o.dismiss())}),t.O4$(),t.TgZ(6,"svg",7),t._UZ(7,"path",8),t.qZA()()(),t.YNc(8,it,28,15,"div",9),t.YNc(9,st,2,1,"app-payment-methods-card",10),t.YNc(10,ct,2,1,"app-payment-methods-crypto",10)}if(2&r){const e=t.oxw(),n=t.MAs(4);t.xp6(2),t.Q6J("ngTemplateOutlet",n),t.xp6(1),t.hij(" ",t.lcZ(4,5,"confirm-payment")," "),t.xp6(5),t.Q6J("ngIf",!e.showPaymentCard&&!e.showPaymentCrypto),t.xp6(1),t.Q6J("ngIf",e.showPaymentCard),t.xp6(1),t.Q6J("ngIf",e.showPaymentCrypto)}}function lt(r,a){if(1&r){const e=t.EpF();t.O4$(),t.TgZ(0,"svg",28),t.NdJ("click",function(){t.CHM(e);const o=t.oxw(),u=t.MAs(1);return t.KtG(o.handleBack(u))}),t.TgZ(1,"g")(2,"g",29),t._UZ(3,"path",30),t.qZA()()()}}let dt=(()=>{class r{constructor(e,n,o){this.checkoutService=e,this.userService=n,this.strategyService=o,this.showPtCrypto=!1,this.showPtCard=!1,this.isOpenChange=new t.vpe,this.amount=0,this.back=new t.vpe,this.type="",this.showPaymentCard=!1,this.showPaymentCrypto=!1,this.paymentMethodsEnum=S,this.payWayList=[],this.show=!1,this.paymentPlatform=b.TRIPLE}ngOnInit(){return(0,y.mG)(this,void 0,void 0,function*(){})}ngOnChanges(e){e.showPtCrypto&&(this.showPaymentCrypto=e.showPtCrypto.currentValue),e.showPtCard&&(this.showPaymentCard=e.showPtCard.currentValue)}handleBack(e){return(0,y.mG)(this,void 0,void 0,function*(){yield e.dismiss(),this.showPaymentCard=!1,this.showPaymentCrypto=!1,this.back.emit()})}showCard(){setTimeout(()=>{this.showPaymentCard=!0,this.showPaymentCrypto=!1},1e3)}showCrypto(){setTimeout(()=>{this.showPaymentCrypto=!0,this.showPaymentCard=!1},1e3)}payWithCard(){this.selectedPlatformCode=this.paymentMethodsEnum.CARD,this.recharge(g.CARD)}payWithCrypto(){this.selectedPlatformCode=this.paymentMethodsEnum.CRYPTO,this.recharge(g.CRYPTO)}recharge(e){"strategy"!==this.type?"deposit"===this.type?this.userService.recharge({amount:this.amount}).subscribe({next:n=>{const o=n.data.id;switch(e){case g.CARD:this.methodsCard.confirm(o,C.BALANCE);break;case g.CRYPTO:this.methodsCrypto.confirm(o,C.BALANCE)}},error:n=>{}}):this.userService.recharge({amount:this.amount}).subscribe({next:n=>{const o=n.data.id;switch(e){case g.CARD:this.methodsCard.confirm(o,C.BALANCE);break;case g.CRYPTO:this.methodsCrypto.confirm(o,C.BALANCE)}},error:n=>{}}):this.strategyService.buyStrategy({realId:String(this.paymentStrategy.id),customerId:String(this.paymentStrategy.selectId),accounts:JSON.parse(this.accounts)}).pipe().subscribe(n=>(0,y.mG)(this,void 0,void 0,function*(){const o=n.data.id;switch(e){case g.CARD:this.methodsCard.confirm(o,C.STRAGY);break;case g.CRYPTO:this.methodsCrypto.confirm(o,C.STRAGY)}}))}}return r.\u0275fac=function(e){return new(e||r)(t.Y36(L),t.Y36(U.K),t.Y36(F))},r.\u0275cmp=t.Xpm({type:r,selectors:[["app-payment-method-modal"]],viewQuery:function(e,n){if(1&e&&(t.Gf(ot,5),t.Gf(at,5)),2&e){let o;t.iGM(o=t.CRH())&&(n.methodsCard=o.first),t.iGM(o=t.CRH())&&(n.methodsCrypto=o.first)}},inputs:{showPtCrypto:"showPtCrypto",showPtCard:"showPtCard",isOpen:"isOpen",accounts:"accounts",amount:"amount",type:"type",paymentStrategy:"paymentStrategy"},outputs:{isOpenChange:"isOpenChange",back:"back"},features:[t.TTD],decls:5,vars:2,consts:[[3,"backdropDismiss","isOpen","didDismiss"],["modal",""],["backIcon",""],[1,"flex","items-center","p-2"],[1,"flex-1","font-bold","text-3xl","flex","items-center"],[3,"ngTemplateOutlet"],[1,"w-8","p-1","rounded","cursor-pointer","bg-[#ff2145]","text-white",3,"click"],["version","1.1","viewBox","0 0 100 100","overflow","visible","enable-background","new 0 0 100 100"],["stroke","currentColor","stroke-width","12","stroke-linecap","square","d","M 10,10 90,90 M 10,90 90,10"],["class","p-4",4,"ngIf"],["style","padding: 10px",3,"amount","select",4,"ngIf"],[1,"p-4"],[1,"flex","justify-between","font-bold","text-2xl"],[1,"mr-2"],[1,"border-b","border-[#dddddd]","my-2"],[1,"text-center","text-2xl","font-bold"],[1,"w-full","bg-gradient-primary","p-1.5","text-center","text-white","rounded-md","flex","items-center","mb-2",3,"click"],[1,"flex-1","xs:ml-2"],[1,"text-base"],["src","assets/images/payment-crypto-min.png","alt","",1,"h-7","m-auto"],[1,"w-full","bg-gradient-primary","p-1.5","text-center","text-white","rounded-md","flex","items-center",3,"click"],[1,"flex","justify-center","items-center","h-7","overflow-hidden"],["src","assets/images/payment-alipay-white-min.png","alt","",1,"h-6","flex-shrink"],["src","assets/images/payment-wechatpay-white-min.png","alt","",1,"h-6","flex-shrink"],["src","assets/images/payment-vise-master-amex-min.png","alt","",1,"h-6","flex-shrink"],[2,"padding","10px",3,"amount","select"],["methodsCard",""],["methodsCrypto",""],["xmlns","http://www.w3.org/2000/svg",0,"xmlns","xlink","http://www.w3.org/1999/xlink","version","1.1","id","Capa_1","x","0px","y","0px","viewBox","0 0 384.97 384.97",0,"xml","space","preserve",1,"cursor-pointer","h-10","mr-2",2,"enable-background","new 0 0 384.97 384.97",3,"click"],["id","Chevron_Left_Circle"],["d","M235.878,99.876c-4.704-4.74-12.319-4.74-17.011,0l-83.009,84.2c-4.572,4.62-4.584,12.56,0,17.191l82.997,84.2    c4.704,4.74,12.319,4.74,17.011,0c4.704-4.752,4.704-12.439,0-17.191l-74.528-75.61l74.54-75.61    C240.57,112.315,240.57,104.628,235.878,99.876z"]],template:function(e,n){1&e&&(t.TgZ(0,"ion-modal",0,1),t.NdJ("didDismiss",function(){return n.isOpenChange.emit(!1)}),t.YNc(2,pt,11,7,"ng-template"),t.qZA(),t.YNc(3,lt,4,0,"ng-template",null,2,t.W1O)),2&e&&t.Q6J("backdropDismiss",!1)("isOpen",n.isOpen)},dependencies:[s.O5,s.tP,h.ki,Y,rt,s.H9,m.X$],styles:["ion-modal[_ngcontent-%COMP%]{--width: 450px;--border-radius: 15px;--height: auto;--background: var(--main-bg);--border-color: var(--main-border);--border-width: 2px;--border-style: solid;--padding: 8px}ion-input[_ngcontent-%COMP%]{--padding-bottom: 0px;--padding-top: 0px}ion-input[_ngcontent-%COMP%]     input{border-radius:0!important}.bg-gradient-primary[_ngcontent-%COMP%]{border-color:#37ff73;background-color:var(--main-green);--tw-text-opacity: 1;color:rgb(255 255 255/var(--tw-text-opacity))}.convert-dollar-btn[_ngcontent-%COMP%]{border-width:2px;border-style:solid;--tw-border-opacity: 1;border-color:rgb(46 213 143 / var(--tw-border-opacity))}button[disabled][_ngcontent-%COMP%]{opacity:.3}"]}),r})();function ut(r,a){1&r&&t._UZ(0,"i",38)}function mt(r,a){1&r&&t._UZ(0,"img",39)}function ht(r,a){1&r&&(t.TgZ(0,"span"),t._uU(1,"+"),t.qZA())}function yt(r,a){if(1&r){const e=t.EpF();t.TgZ(0,"button",32),t.NdJ("click",function(){t.CHM(e);const o=t.oxw();return t.KtG(o.payWithBalance())}),t.TgZ(1,"div"),t._uU(2),t.ALo(3,"translate"),t.qZA(),t.TgZ(4,"div",40),t._uU(5),t.ALo(6,"currency"),t.qZA()()}if(2&r){const e=t.oxw();t.xp6(2),t.Oqu(t.lcZ(3,2,"pay-using-account-credit")),t.xp6(3),t.Oqu(t.lcZ(6,4,e.walletInfo.balance))}}const gt=function(r){return{amount:r}},ft=[{path:"",component:(()=>{class r extends R.H{constructor(e,n){super(),this.route=e,this.walletService=n,this.count=0,this.amount=0,this.orderType=null,this.accountCredits=35.23,this.isOpenPaymentMethodModal=!1,this.showPaymentCard=!1,this.showPaymentCrypto=!1,this.walletInfo={},this.route.queryParams.subscribe(o=>{this.count=o.count||0,this.amount=o.amount||0,this.orderType=o.orderType||null}),this.getWalletInfo()}ngOnInit(){}get orderTitle(){return this.orderType===T.mr.Gift?"purchase-gift-codes":this.orderType===T.mr.Deposit?"deposit-account-credits":""}get orderSubTitle(){return this.orderType===T.mr.Gift?"purchase-gift-codes-subtitle":this.orderType===T.mr.Deposit?"deposit-account-credits-subtitle":""}get isDepositOrder(){return this.orderType===T.mr.Deposit}handleBack(){this.router.navigateByUrl("/dashboard")}payWithBalance(){}getWalletInfo(){this.walletService.walletInfo().pipe().subscribe(e=>(0,y.mG)(this,void 0,void 0,function*(){if(0===e.code)return this.walletInfo=e.data,void console.log(e)}))}}return r.\u0275fac=function(e){return new(e||r)(t.Y36(i.gz),t.Y36(I.X))},r.\u0275cmp=t.Xpm({type:r,selectors:[["app-confirm-order"]],features:[t.qOj],decls:85,vars:57,consts:[[3,"fullscreen"],[1,"confirm-page-container","flex","flex-wrap","font-medium","px-2","py-4","lg:pt-32"],[1,"w-full","lg:w-7/12","my-2","lg:pr-4"],[1,"border","border-main-border","bg-grey-4","rounded-xl","px-3","py-2"],[1,"text-text-strong","flex","text-3xl","capitalize"],[1,"border-b","border-main-border","mt-2","mb-3"],[1,"flex","items-center","mb-3"],["class","button-icon icon-download text-main-green text-4xl mb-1 mr-2",4,"ngIf","ngIfElse"],["GiftOrderTemplate",""],[1,"flex-1"],[1,"text-text-strong","text-xl","leading-5","capitalize"],[1,"inline-flex"],[4,"ngIf"],[1,"text-xl","w-8"],[1,"text-grey-1"],[1,"w-3/12","text-right","text-xl"],[1,"flex","items-center","text-2xl","text-text-strong"],[1,"w-full","lg:w-5/12","my-2"],[1,"border","border-main-border","bg-grey-4","rounded-xl","px-3","py-2","text-xl"],[1,"flex","items-center"],[1,"flex-1","text-3xl","text-text-strong"],[1,"border-b","border-main-border","mt-2","mb-2"],[1,"flex","items-center","text-xl"],[1,"flex-1","text-text-strong"],[1,"border-b","border-main-border","my-2"],[1,"flex","items-center","text-xl","text-text-strong"],[1,"flex-1","text-2xl"],[1,"my-3"],[1,"text-2xl","text-text-strong","text-center","mb-2","capitalize"],["class","payment-btn w-full text-xl mb-2 capitalize",3,"click",4,"ngIf"],[1,"payment-btn","w-full","text-xl","mb-2","flex","flex-col","justify-center","items-center","capitalize",3,"click"],["src","assets/images/payment-crypto-min.png","alt","",1,"h-6"],[1,"payment-btn","w-full","text-xl","mb-2","capitalize",3,"click"],[1,"flex","justify-center"],["src","assets/images/payment-alipay-dark-min.png","alt","",1,"h-6"],["src","assets/images/payment-wechatpay-dark-min.png","alt","",1,"h-6"],["src","assets/images/payment-vise-master-amex-min.png","alt","",1,"h-6"],[3,"type","showPtCrypto","showPtCard","amount","isOpen","isOpenChange"],[1,"button-icon","icon-download","text-main-green","text-4xl","mb-1","mr-2"],["src","assets/icon/wallet/gift-box.png","alt","Gift",1,"left-3","h-11","mr-1"],[1,"text-2xl"]],template:function(e,n){if(1&e&&(t.TgZ(0,"ion-content",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4),t._UZ(5,"app-top-back-button"),t._uU(6),t.ALo(7,"translate"),t.qZA(),t._UZ(8,"div",5),t.TgZ(9,"div",6),t.YNc(10,ut,1,0,"i",7),t.YNc(11,mt,1,0,"ng-template",null,8,t.W1O),t.TgZ(13,"div",9)(14,"div",10),t._uU(15),t.ALo(16,"translate"),t.qZA(),t.TgZ(17,"div",11),t.YNc(18,ht,2,0,"span",12),t._uU(19),t.ALo(20,"translate"),t.qZA()(),t.TgZ(21,"div",13)(22,"span"),t._uU(23,"X"),t.qZA(),t.TgZ(24,"span",14),t._uU(25),t.qZA()(),t.TgZ(26,"div",15),t._uU(27),t.ALo(28,"currency"),t.qZA()(),t._UZ(29,"div",5),t.TgZ(30,"div",16)(31,"div",9),t._uU(32),t.ALo(33,"translate"),t.qZA(),t.TgZ(34,"div"),t._uU(35),t.ALo(36,"currency"),t.qZA()()()(),t.TgZ(37,"div",17)(38,"div",18)(39,"div",19)(40,"div",20),t._uU(41,"Order Total"),t.qZA(),t.TgZ(42,"div"),t._uU(43),t.qZA()(),t._UZ(44,"div",21),t.TgZ(45,"div",22)(46,"div",23),t._uU(47,"Subtotal"),t.qZA(),t.TgZ(48,"div"),t._uU(49),t.ALo(50,"currency"),t.qZA()(),t.TgZ(51,"div",22)(52,"div",23),t._uU(53),t.ALo(54,"translate"),t.qZA(),t.TgZ(55,"div"),t._uU(56),t.ALo(57,"currency"),t.qZA()(),t._UZ(58,"div",24),t.TgZ(59,"div",25)(60,"div",26),t._uU(61),t.ALo(62,"translate"),t.qZA(),t.TgZ(63,"div"),t._uU(64),t.ALo(65,"currency"),t.qZA()()(),t.TgZ(66,"div",27)(67,"div",28),t._uU(68),t.ALo(69,"translate"),t.qZA(),t.YNc(70,yt,7,6,"button",29),t.TgZ(71,"button",30),t.NdJ("click",function(){return n.showPaymentCrypto=!0,n.showPaymentCard=!1,n.isOpenPaymentMethodModal=!0}),t.TgZ(72,"div"),t._uU(73),t.ALo(74,"translate"),t.qZA(),t._UZ(75,"img",31),t.qZA(),t.TgZ(76,"button",32),t.NdJ("click",function(){return n.showPaymentCard=!0,n.showPaymentCrypto=!1,n.isOpenPaymentMethodModal=!0}),t.TgZ(77,"div"),t._uU(78),t.ALo(79,"translate"),t.qZA(),t.TgZ(80,"div",33),t._UZ(81,"img",34)(82,"img",35)(83,"img",36),t.qZA()()()()()(),t.TgZ(84,"app-payment-method-modal",37),t.NdJ("isOpenChange",function(u){return n.isOpenPaymentMethodModal=u}),t.qZA()),2&e){const o=t.MAs(12);t.Q6J("fullscreen",!0),t.xp6(6),t.hij(" ",t.lcZ(7,26,"confirm-order")," "),t.xp6(4),t.Q6J("ngIf",n.isDepositOrder)("ngIfElse",o),t.xp6(5),t.hij(" ",t.lcZ(16,28,n.orderTitle)," "),t.xp6(3),t.Q6J("ngIf",n.isDepositOrder),t.xp6(1),t.hij(" ",t.xi3(20,30,n.orderSubTitle,t.VKq(55,gt,n.amount))," "),t.xp6(6),t.Oqu(n.count),t.xp6(2),t.Oqu(t.lcZ(28,33,n.amount)),t.xp6(5),t.Oqu(t.lcZ(33,35,"Subtotal")),t.xp6(3),t.Oqu(t.lcZ(36,37,n.amount*n.count)),t.xp6(8),t.hij("",n.count," Items"),t.xp6(6),t.Oqu(t.lcZ(50,39,n.count*n.amount)),t.xp6(4),t.hij(" ",t.lcZ(54,41,"Activation Fee")," "),t.xp6(3),t.Oqu(t.lcZ(57,43,0)),t.xp6(5),t.Oqu(t.lcZ(62,45,"Total")),t.xp6(3),t.Oqu(t.lcZ(65,47,n.count*n.amount)),t.xp6(4),t.hij(" ",t.lcZ(69,49,"select-payment-method")," "),t.xp6(2),t.Q6J("ngIf","deposit"!==n.orderType),t.xp6(3),t.Oqu(t.lcZ(74,51,"pay-using-crypto")),t.xp6(5),t.Oqu(t.lcZ(79,53,"pay-using-card")),t.xp6(6),t.Q6J("type",n.orderType)("showPtCrypto",n.showPaymentCrypto)("showPtCard",n.showPaymentCard)("amount",n.amount)("isOpen",n.isOpenPaymentMethodModal)}},dependencies:[s.O5,h.W2,q,dt,s.H9,m.X$],styles:[".confirm-page-container[_ngcontent-%COMP%]{width:1200px;max-width:100%;margin:auto}.payment-btn[_ngcontent-%COMP%]{background:linear-gradient(to right,#FEDF3C,#FFDF2B);border-radius:.375rem;--tw-text-opacity: 1;color:rgb(0 0 0 / var(--tw-text-opacity));height:70px}"]}),r})()}];let _t=(()=>{class r{}return r.\u0275fac=function(e){return new(e||r)},r.\u0275mod=t.oAB({type:r}),r.\u0275inj=t.cJS({imports:[i.Bz.forChild(ft),i.Bz]}),r})(),Ct=(()=>{class r{}return r.\u0275fac=function(e){return new(e||r)},r.\u0275mod=t.oAB({type:r}),r.\u0275inj=t.cJS({imports:[s.ez,f.u5,h.Pc,_t,c.x,m.aw,_.kb,A.T,d.Q]}),r})()},7102:(M,P,l)=>{l.d(P,{OO:()=>h,XC:()=>m,Zs:()=>s,gl:()=>f,mr:()=>d,nC:()=>c});var s=(()=>{return(i=s||(s={})).Deposit="deposit",i.Spend="spend",s;var i})(),f=(()=>{return(i=f||(f={})).Unused="Unused",i.Redeemed="Redeemed",f;var i})(),h=(()=>((h||(h={})).Convert="Convert",h))(),m=(()=>{return(i=m||(m={})).Reward="Reward",i.Swap="convert",i.Receive="Receive",m;var i})(),c=(()=>{return(i=c||(c={})).Credits="credits",i.Options="options",c;var i})(),d=(()=>{return(i=d||(d={})).Deposit="deposit",i.Withdraw="withdraw",i.Gift="gift",d;var i})()},6339:(M,P,l)=>{l.d(P,{X:()=>m});var s=l(2340),f=l(4650),h=l(529);let m=(()=>{class _{constructor(c){this.http=c}ottoOptionsLog(c,d,i){return this.http.get(`${s.N.BASE_URL}/user/wallet/ottoOptionsLog?balanceType=${i}&page=${c}&rows=${d}`)}balanceLog(c,d,i){return this.http.get(`${s.N.BASE_URL}/user/wallet/balanceLog?balanceType=${i}&page=${c}&rows=${d}`)}giftLog(c,d,i){return this.http.get(`${s.N.BASE_URL}/user/wallet/giftLog?balanceType=${i}&page=${c}&rows=${d}`)}pointLog(c,d,i){return this.http.get(`${s.N.BASE_URL}/user/wallet/pointLog?balanceType=${i}&page=${c}&rows=${d}`)}walletInfo(){return this.http.get(`${s.N.BASE_URL}/user/wallet/info`)}buyGift(c){return this.http.post(`${s.N.BASE_URL}/user/wallet/buyGift`,c)}pointExchangeBalance(c){return this.http.post(`${s.N.BASE_URL}/user/wallet/pointExchangeBalance`,c)}exchangeOttoOptions(c){return this.http.post(`${s.N.BASE_URL}/user/wallet/exchangeOttoOptions`,c)}exchangeGift(c){return this.http.post(`${s.N.BASE_URL}/user/wallet/exchangeGift`,c)}givePoint(c){return this.http.post(`${s.N.BASE_URL}/user/wallet/giveBalance`,c)}getQrCode(){return this.http.get(`${s.N.BASE_URL}/user/setUp/googleAuth/getQrCode`)}sendCode(c){return this.http.post(`${s.N.BASE_URL}/user/setUp/googleAuth/bindGoogleAuth`,c)}}return _.\u0275fac=function(c){return new(c||_)(f.LFG(h.eN))},_.\u0275prov=f.Yz7({token:_,factory:_.\u0275fac,providedIn:"root"}),_})()}}]);