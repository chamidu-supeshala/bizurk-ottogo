"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[2584],{2584:($,S,l)=>{l.r(S),l.d(S,{ConfirmOrderPageModule:()=>Wt});var u=l(6895),d=l(4006),y=l(8008),h=l(3416),v=l(5433),I=l(8854),x=l(8634),L=l(9116),U=l(3709),b=l(655),T=l(9808),E=l(2722),i=l(7154),s=l(7102),c=l(1781),O=l(9769),w=l.n(O),t=l(4650),P=l(6339),Z=l(5987),m=l(5939),A=l(5548);let F=(()=>{class r extends i.H{constructor(e){super(),this.location=e}ngOnInit(){}handleClick(){return(0,b.mG)(this,void 0,void 0,function*(){this.router.navigated?this.location.back():this.router.navigate(["/"],{replaceUrl:!0})})}}return r.\u0275fac=function(e){return new(e||r)(t.Y36(u.Ye))},r.\u0275cmp=t.Xpm({type:r,selectors:[["app-top-back-button"]],features:[t.qOj],decls:2,vars:0,consts:[[1,"cursor-pointer","w-8","h-8",3,"click"],["name","chevron-back-outline",1,"w-8","h-8"]],template:function(e,n){1&e&&(t.TgZ(0,"div",0),t.NdJ("click",function(){return n.handleClick()}),t._UZ(1,"ion-icon",1),t.qZA())},dependencies:[y.gu]}),r})();var Y=l(8222),B=l(9642),z=l(6832),N=l(4950);function Q(r,o){1&r&&t._UZ(0,"img",19)}function V(r,o){1&r&&t._UZ(0,"img",20)}function H(r,o){1&r&&t._UZ(0,"img",21)}function K(r,o){1&r&&t._UZ(0,"img",22)}function X(r,o){1&r&&t._UZ(0,"app-check-circle",23)}function tt(r,o){1&r&&(t.TgZ(0,"span"),t._uU(1," + "),t.qZA())}function et(r,o){if(1&r&&(t.TgZ(0,"app-number-field",24)(1,"div",25)(2,"span",26),t._uU(3," X "),t.qZA()()()),2&r){const e=t.oxw();let n;t.Q6J("min",null!==(n=e.getValue("minQuantity"))&&void 0!==n?n:0)("step",1)}}function nt(r,o){if(1&r&&(t.TgZ(0,"app-number-field",27)(1,"div",25)(2,"span",26),t._uU(3," $ "),t.qZA()()()),2&r){const e=t.oxw();let n,a;t.Q6J("min",null!==(n=e.getValue("minAmount"))&&void 0!==n?n:0)("digits",2)("step",null!==(a=e.getValue("amountStepBy"))&&void 0!==a?a:1)}}function rt(r,o){if(1&r&&(t.TgZ(0,"div",28)(1,"span"),t._uU(2,"X"),t.qZA(),t.TgZ(3,"span",29),t._uU(4),t.qZA()()),2&r){const e=t.oxw();t.xp6(4),t.hij(" ",e.getValue("quantity")," ")}}function at(r,o){if(1&r&&(t.TgZ(0,"div",31)(1,"div",8)(2,"div",32),t._uU(3),t.ALo(4,"currency"),t.qZA(),t.TgZ(5,"div"),t._uU(6),t.ALo(7,"currency"),t.qZA()()()),2&r){const e=t.oxw(2);t.xp6(3),t.hij(" ",t.lcZ(4,2,e.getValue("originalAmount"))," "),t.xp6(3),t.hij(" ",t.lcZ(7,4,e.getValue("amount"))," ")}}function it(r,o){if(1&r&&t.YNc(0,at,8,6,"div",30),2&r){const e=t.oxw(),n=t.MAs(25);t.Q6J("ngIf",e.getValue("originalAmount"))("ngIfElse",n)}}function st(r,o){if(1&r&&(t.TgZ(0,"div",31),t._uU(1),t.ALo(2,"currency"),t.qZA()),2&r){const e=t.oxw();t.xp6(1),t.hij(" ",t.lcZ(2,1,e.totalItemAmount)," ")}}const ot=function(r,o){return{amountPerItem:r,amount:o}};let lt=(()=>{class r extends i.H{constructor(){super(...arguments),this.itemTypes=s.yh}get itemType(){return this.orderItem.get("type").value}get totalItemAmount(){return(this.getValue("amount")*this.getValue("quantity")).toFixed(2)}get itemTitle(){switch(this.itemType){case s.yh.AcountCredit:return"add-account-credits-title";case s.yh.Gift:return"purchase-gift-codes";case s.yh.HashPower:return"add-hashpower-title";case s.yh.FreeMembership:return"checkout-free-membership-title";case s.yh.Strategy:return"activate-strategy";default:return""}}get itemSubTitle(){switch(this.itemType){case s.yh.AcountCredit:return"add-account-credits-subtitle";case s.yh.Gift:return"purchase-gift-codes-subtitle";case s.yh.HashPower:return"add-hashpower-subtitle";case s.yh.FreeMembership:return"checkout-free-membership-subtitle";case s.yh.Strategy:return this.getValue("name");default:return""}}getValue(e){var n;return null===(n=this.orderItem.get(e))||void 0===n?void 0:n.value}}return r.\u0275fac=function(){let o;return function(n){return(o||(o=t.n5z(r)))(n||r)}}(),r.\u0275cmp=t.Xpm({type:r,selectors:[["app-order-item"]],inputs:{orderItem:"orderItem"},features:[t.qOj],decls:26,vars:22,consts:[[1,"checkout-order-item","flex","flex-col","sm:flex-row","items-start","sm:items-center","justify-between","mb-3",3,"formGroup"],[1,"flex"],[3,"ngSwitch"],["class","left-3 h-10 mr-2","src","assets/icon/wallet/ottopoints-green.png","alt","Account Credit",4,"ngSwitchCase"],["class","left-3 h-10 mr-2","src","assets/icon/wallet/gift-box.png","alt","Gift",4,"ngSwitchCase"],["class","left-3 h-10 mr-2","src","assets/icon/wallet/hash-power.png","alt","Hash Power",4,"ngSwitchCase"],["class","left-3 h-10 mr-2","src","assets/icon/wallet/membership.png","alt","Free Membership",4,"ngSwitchCase"],["class","w-10 left-3 h-10 mr-2 text-main-blue",4,"ngSwitchCase"],[1,"flex-col"],[1,"text-text-strong","text-xl","leading-5","capitalize"],[1,"inline-flex"],[4,"ngIf"],[1,"text-xl","flex","self-end","mt-2","sm:mt-0"],["class","!text-grey-1 w-20 item-quantity","formControlName","quantity",3,"min","step",4,"ngIf","ngIfElse"],["class","!text-grey-1 ml-1.5 item-amount","formControlName","amount",3,"min","digits","step",4,"ngIf","ngIfElse"],[1,"border-b","border-main-border","mt-2","mb-3"],["quantityReadOnly",""],["amountReadOnly",""],["amountWrapper",""],["src","assets/icon/wallet/ottopoints-green.png","alt","Account Credit",1,"left-3","h-10","mr-2"],["src","assets/icon/wallet/gift-box.png","alt","Gift",1,"left-3","h-10","mr-2"],["src","assets/icon/wallet/hash-power.png","alt","Hash Power",1,"left-3","h-10","mr-2"],["src","assets/icon/wallet/membership.png","alt","Free Membership",1,"left-3","h-10","mr-2"],[1,"w-10","left-3","h-10","mr-2","text-main-blue"],["formControlName","quantity",1,"!text-grey-1","w-20","item-quantity",3,"min","step"],["slot","start"],[1,"ml-2","text-xl","text-grey-1","font-medium"],["formControlName","amount",1,"!text-grey-1","ml-1.5","item-amount",3,"min","digits","step"],[1,"text-grey-1","w-20","flex","self-center","pl-2"],[1,"ml-2"],["class","text-grey-1 w-32 text-right flex self-center justify-end",4,"ngIf","ngIfElse"],[1,"text-grey-1","w-32","text-right","flex","self-center","justify-end"],[1,"line-through","text-base"]],template:function(e,n){if(1&e&&(t.TgZ(0,"div",0)(1,"div",1),t.ynx(2,2),t.YNc(3,Q,1,0,"img",3),t.YNc(4,V,1,0,"img",4),t.YNc(5,H,1,0,"img",5),t.YNc(6,K,1,0,"img",6),t.YNc(7,X,1,0,"app-check-circle",7),t.BQk(),t.TgZ(8,"div",8)(9,"div",9),t._uU(10),t.ALo(11,"translate"),t.qZA(),t.TgZ(12,"div",10),t.YNc(13,tt,2,0,"span",11),t._uU(14),t.ALo(15,"translate"),t.qZA()()(),t.TgZ(16,"div",12),t.YNc(17,et,4,2,"app-number-field",13),t.YNc(18,nt,4,3,"app-number-field",14),t.qZA()(),t._UZ(19,"div",15),t.YNc(20,rt,5,1,"ng-template",null,16,t.W1O),t.YNc(22,it,1,2,"ng-template",null,17,t.W1O),t.YNc(24,st,3,3,"ng-template",null,18,t.W1O)),2&e){const a=t.MAs(21),p=t.MAs(23);t.Q6J("formGroup",n.orderItem),t.xp6(2),t.Q6J("ngSwitch",n.itemType),t.xp6(1),t.Q6J("ngSwitchCase",n.itemTypes.AcountCredit),t.xp6(1),t.Q6J("ngSwitchCase",n.itemTypes.Gift),t.xp6(1),t.Q6J("ngSwitchCase",n.itemTypes.HashPower),t.xp6(1),t.Q6J("ngSwitchCase",n.itemTypes.FreeMembership),t.xp6(1),t.Q6J("ngSwitchCase",n.itemTypes.Strategy),t.xp6(3),t.hij(" ",t.lcZ(11,14,n.itemTitle)," "),t.xp6(3),t.Q6J("ngIf",n.itemType===n.itemTypes.HashPower),t.xp6(1),t.hij(" ",t.xi3(15,16,n.itemSubTitle,t.WLB(19,ot,n.getValue("amount"),n.totalItemAmount))," "),t.xp6(3),t.Q6J("ngIf",!n.getValue("quantityReadOnly"))("ngIfElse",a),t.xp6(1),t.Q6J("ngIf",!n.getValue("amountReadOnly"))("ngIfElse",p)}},dependencies:[u.O5,u.RF,u.n9,d.JJ,d.JL,d.sg,d.u,z.r,N.E,u.H9,h.X$],styles:[".checkout-order-item .item-quantity ion-input,   .checkout-order-item .item-amount ion-input{font-size:1.25rem;line-height:1.75rem}  .checkout-order-item .item-quantity ion-icon,   .checkout-order-item .item-amount ion-icon{height:.75rem;width:.75rem}  .checkout-order-item .item-amount{width:122px}"]}),r})();var ct=l(7011),q=l(7341),dt=l(2340),pt=l(529);let j=(()=>{class r{constructor(e){this.http=e}payV2(e){return this.http.post(`${dt.N.BASE_URL}/payment/pay`,e)}}return r.\u0275fac=function(e){return new(e||r)(t.LFG(pt.eN))},r.\u0275prov=t.Yz7({token:r,factory:r.\u0275fac,providedIn:"root"}),r})();function ut(r,o){if(1&r){const e=t.EpF();t.TgZ(0,"button",7),t.NdJ("click",function(){const p=t.CHM(e).$implicit,_=t.oxw(2);return t.KtG(_.selectPayWay(p.platformCode))}),t._UZ(1,"img",8),t._uU(2),t.ALo(3,"translate"),t.qZA()}if(2&r){const e=o.$implicit;t.xp6(1),t.Q6J("src",e.icon,t.LSH),t.xp6(1),t.hij(" ",t.lcZ(3,2,e.name)," ")}}function mt(r,o){if(1&r&&(t.TgZ(0,"div",3)(1,"div",4),t._uU(2),t.ALo(3,"translate"),t.qZA(),t.TgZ(4,"div",5),t._uU(5),t.ALo(6,"currency"),t.qZA(),t.TgZ(7,"div",4),t._uU(8),t.ALo(9,"translate"),t.qZA(),t.YNc(10,ut,4,4,"button",6),t.qZA()),2&r){const e=t.oxw();t.xp6(2),t.hij("",t.lcZ(3,4,"checkout-confirm-amount-to-be-paid"),":"),t.xp6(3),t.Oqu(t.lcZ(6,6,e.amount)),t.xp6(3),t.hij("",t.lcZ(9,8,"checkout-confirm-choose-method"),":"),t.xp6(2),t.Q6J("ngForOf",e.payWayList)}}function ht(r,o){1&r&&t._UZ(0,"div",9)}let gt=(()=>{class r extends q.u{constructor(e,n,a,p){super(),this.checkoutService=e,this.paymentSrv=n,this.cdRef=a,this.location=p,this.businessId=0,this.businessType=c.ri.AGGREGATE,this.successCallbackUrl="",this.errorCallbackUrl="",this.select=new t.vpe,this.paymentPlatform=c.fS.TRIPLE,this.payWayList=[],this.selectedPlatformCode="",this.show=!1,this.loading={createPayOrder:!1,pay:!1},this.getPlayForm()}ngOnInit(){return(0,b.mG)(this,void 0,void 0,function*(){})}getPlayForm(){return(0,b.mG)(this,void 0,void 0,function*(){this.checkoutService.queryPlatformList().pipe().subscribe(e=>(0,b.mG)(this,void 0,void 0,function*(){this.payWayList=null==e?void 0:e.data.filter(n=>Object.is(n.platformGroup,this.paymentPlatform)&&!Object.is(n.platformCode,this.paymentPlatform)),this.cdRef.detectChanges(),this.show=!0,console.log("this.payWayList333",this.payWayList)}))})}selectPayWay(e){this.selectedPlatformCode=e,this.confirmOrder(this.businessId,this.businessType)}confirmOrder(e,n){this.paymentSrv.payV2({platformCode:this.selectedPlatformCode,paymentType:c.uG.client,businessId:String(e),dynamicSuccess:this.successCallbackUrl,dynamicCancel:this.errorCallbackUrl,businessType:n}).pipe().subscribe({next:a=>{this.payResult=a.data,Object.is(a.code,0)?this.loadTriple():this.toast.toastError(a.message)},error:a=>{console.error(a)}}).add(()=>{this.loading.createPayOrder=!1})}loadTriple(){console.log(this.payResult);const e=JSON.parse(this.payResult.clientJson);console.log(e),this.cdRef.detectChanges();const n=document.querySelector("#payment-element");this.loading.createPayOrder=!0,console.log(n),n&&(n.innerHTML=`\n    <triplea-ecommerce-payment-v1\n    id="payment"\n    payment-reference="${e.paymentReference}"\n    access-token="${e.accessToken}"\n    lang="zh"\n    ></triplea-ecommerce-payment-v1>\n   `,console.log(n))}}return r.\u0275fac=function(e){return new(e||r)(t.Y36(Z.Z),t.Y36(j),t.Y36(t.sBO),t.Y36(u.Ye))},r.\u0275cmp=t.Xpm({type:r,selectors:[["app-payment-methods-crypto"]],inputs:{amount:"amount",businessId:"businessId",businessType:"businessType",successCallbackUrl:"successCallbackUrl",errorCallbackUrl:"errorCallbackUrl"},outputs:{select:"select"},features:[t.qOj],decls:4,vars:2,consts:[[1,"payment-methods-crypto"],["class","methods",4,"ngIf","ngIfElse"],["paymentElement",""],[1,"methods"],[1,"title"],[1,"amount-value"],["class","btn-payWay","nz-button","","nzBlock","","nzSize","large",3,"click",4,"ngFor","ngForOf"],["nz-button","","nzBlock","","nzSize","large",1,"btn-payWay",3,"click"],["alt","icon",1,"icon",3,"src"],["id","payment-element",1,"payment-element"]],template:function(e,n){if(1&e&&(t.TgZ(0,"div",0),t.YNc(1,mt,11,10,"div",1),t.YNc(2,ht,1,0,"ng-template",null,2,t.W1O),t.qZA()),2&e){const a=t.MAs(3);t.xp6(1),t.Q6J("ngIf",!n.payResult&&!n.loading.createPayOrder)("ngIfElse",a)}},dependencies:[u.sg,u.O5,u.H9,h.X$],styles:['.payment-methods-crypto[_ngcontent-%COMP%]   .btn-payWay[_ngcontent-%COMP%]{border-color:#e0e5eb;border-radius:5px;margin-bottom:4px;text-align:left;display:flex;align-items:center;position:relative;border:1px solid #f3f3f3;width:100%;padding:10px 3px}.payment-methods-crypto[_ngcontent-%COMP%]   .btn-payWay[_ngcontent-%COMP%]:after{display:block;content:">";position:absolute;line-height:40px;right:8px;top:0;color:#ccc}.payment-methods-crypto[_ngcontent-%COMP%]   .btn-payWay[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]{height:24px;margin-right:4px}.payment-methods-crypto[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{color:#858a8e;font-size:20px;margin-top:16px}.payment-methods-crypto[_ngcontent-%COMP%]   .amount-value[_ngcontent-%COMP%]{font-weight:700;font-size:24px}.payment-methods-crypto[_ngcontent-%COMP%]   .payment-element[_ngcontent-%COMP%]{margin-top:16px}']}),r})();var W="https://js.stripe.com/v3",yt=/^https:\/\/js\.stripe\.com\/v3\/?(\?.*)?$/,G="loadStripe.setLoadParameters was called but an existing Stripe.js script already exists in the document; existing script parameters will be used",R=null,Ct=function(o,e,n){if(null===o)return null;var a=o.apply(void 0,e);return function(o,e){!o||!o._registerWrapper||o._registerWrapper({name:"stripe-js",version:"1.54.0",startTime:e})}(a,n),a},J=Promise.resolve().then(function(){return o=null,null!==R||(R=new Promise(function(e,n){if(typeof window>"u"||typeof document>"u")e(null);else if(window.Stripe&&o&&console.warn(G),window.Stripe)e(window.Stripe);else try{var a=function(){for(var o=document.querySelectorAll('script[src^="'.concat(W,'"]')),e=0;e<o.length;e++){var n=o[e];if(yt.test(n.src))return n}return null}();a&&o?console.warn(G):a||(a=function(o){var e=o&&!o.advancedFraudSignals?"?advancedFraudSignals=false":"",n=document.createElement("script");n.src="".concat(W).concat(e);var a=document.head||document.body;if(!a)throw new Error("Expected document.body not to be null. Stripe.js requires a <body> element.");return a.appendChild(n),n}(o)),a.addEventListener("load",function(){window.Stripe?e(window.Stripe):n(new Error("Stripe.js not available"))}),a.addEventListener("error",function(){n(new Error("Failed to load Stripe.js"))})}catch(p){return void n(p)}})),R;var o}),D=!1;function Ot(r,o){if(1&r){const e=t.EpF();t.TgZ(0,"button",7),t.NdJ("click",function(){const p=t.CHM(e).$implicit,_=t.oxw(2);return t.KtG(_.selectPayWay(p.platformCode))}),t._uU(1),t.ALo(2,"translate"),t._UZ(3,"img",8),t.qZA()}if(2&r){const e=o.$implicit;t.xp6(1),t.hij(" ",t.lcZ(2,2,e.name)," "),t.xp6(2),t.Q6J("src",e.icon,t.LSH)}}function Pt(r,o){if(1&r&&(t.TgZ(0,"div",3)(1,"div",4),t._uU(2),t.ALo(3,"translate"),t.qZA(),t.TgZ(4,"div",5),t._uU(5),t.ALo(6,"currency"),t.qZA(),t.TgZ(7,"div",4),t._uU(8),t.ALo(9,"translate"),t.qZA(),t.YNc(10,Ot,4,4,"button",6),t.qZA()),2&r){const e=t.oxw();t.xp6(2),t.hij("",t.lcZ(3,4,"checkout-confirm-amount-to-be-paid"),":"),t.xp6(3),t.Oqu(t.lcZ(6,6,e.amount)),t.xp6(3),t.hij("",t.lcZ(9,8,"checkout-confirm-choose-method"),":"),t.xp6(2),t.Q6J("ngForOf",e.payWayList)}}function Tt(r,o){if(1&r){const e=t.EpF();t._UZ(0,"div",9),t.TgZ(1,"button",10),t.NdJ("click",function(){t.CHM(e);const a=t.oxw();return t.KtG(a.pay())}),t._uU(2),t.ALo(3,"translate"),t.qZA()}2&r&&(t.xp6(2),t.hij(" ",t.lcZ(3,1,"checkout-confirm-pay-now")," "))}J.catch(function(r){D||console.warn(r)});let wt=(()=>{class r extends q.u{constructor(e,n,a,p){super(),this.checkoutService=e,this.paymentSrv=n,this.cdRef=a,this.location=p,this.businessId=0,this.businessType=c.ri.AGGREGATE,this.successCallbackUrl="",this.errorCallbackUrl="",this.select=new t.vpe,this.paymentPlatform=c.fS.STRIPE,this.payWayList=[],this.selectedPlatformCode="",this.successCallbackUri="",this.loading={createPayOrder:!1,pay:!1}}ngOnInit(){var e;return(0,b.mG)(this,void 0,void 0,function*(){this.payWayList=null===(e=yield(0,T.n)(this.checkoutService.queryPlatformList()))||void 0===e?void 0:e.data.filter(n=>Object.is(n.platformGroup,this.paymentPlatform)&&!Object.is(n.platformCode,this.paymentPlatform)),this.cdRef.detectChanges()})}selectPayWay(e){this.selectedPlatformCode=e,this.confirmOrder(this.businessId,this.businessType)}confirmOrder(e,n){this.loading.createPayOrder=!0,this.paymentSrv.payV2({platformCode:this.selectedPlatformCode,paymentType:c.uG.client,businessId:String(e),dynamicSuccess:this.successCallbackUrl,dynamicCancel:this.errorCallbackUrl,businessType:n}).subscribe({next:a=>{this.payResult=a.data,Object.is(a.code,0)?this.loadStripe():this.toast.toastError(a.message)},error:a=>{console.error(a)}}).add(()=>{this.loading.createPayOrder=!1})}loadStripe(){return(0,b.mG)(this,void 0,void 0,function*(){try{console.log(this.payResult);const e=JSON.parse(this.payResult.clientJson),{clientSecret:n,pubKey:a,successUri:p}=e,_=yield function(){for(var o=arguments.length,e=new Array(o),n=0;n<o;n++)e[n]=arguments[n];D=!0;var a=Date.now();return J.then(function(p){return Ct(p,e,a)})}(a),k={text:"\u7b80\u4f53\u4e2d\u6587",abbr:"\u{1f1e8}\u{1f1f3}",stripe:"zh",tripleA:"zh"};if(this.successCallbackUri=p,!_)return;this.cdRef.detectChanges(),this.stripe=_,this.stripeElements=_.elements({appearance:{theme:"stripe"},locale:k.stripe,clientSecret:n}),this.loading.createPayOrder=!0,this.stripeElements.create("payment").mount("#payment-element")}catch(e){console.error(e)}})}pay(){return(0,b.mG)(this,void 0,void 0,function*(){this.loading.pay=!0;try{const{error:e}=yield this.stripe.confirmPayment({elements:this.stripeElements,confirmParams:{return_url:this.successCallbackUri}});console.error(e)}catch(e){console.error(e)}finally{this.loading.pay=!1}})}}return r.\u0275fac=function(e){return new(e||r)(t.Y36(Z.Z),t.Y36(j),t.Y36(t.sBO),t.Y36(u.Ye))},r.\u0275cmp=t.Xpm({type:r,selectors:[["app-payment-methods-card"]],inputs:{amount:"amount",businessId:"businessId",businessType:"businessType",successCallbackUrl:"successCallbackUrl",errorCallbackUrl:"errorCallbackUrl"},outputs:{select:"select"},features:[t.qOj],decls:4,vars:2,consts:[[1,"payment-methods-card"],["class","methods",4,"ngIf","ngIfElse"],["paymentElement",""],[1,"methods"],[1,"title"],[1,"amount-value"],["class","btn-payWay","nz-button","","nzBlock","","nzSize","large",3,"click",4,"ngFor","ngForOf"],["nz-button","","nzBlock","","nzSize","large",1,"btn-payWay",3,"click"],["alt","icon",1,"icon",3,"src"],["id","payment-element"],[1,"btn-pay",3,"click"]],template:function(e,n){if(1&e&&(t.TgZ(0,"div",0),t.YNc(1,Pt,11,10,"div",1),t.YNc(2,Tt,4,3,"ng-template",null,2,t.W1O),t.qZA()),2&e){const a=t.MAs(3);t.xp6(1),t.Q6J("ngIf",!n.payResult&&!n.loading.createPayOrder)("ngIfElse",a)}},dependencies:[u.sg,u.O5,u.H9,h.X$],styles:['.payment-methods-card[_ngcontent-%COMP%]   .btn-payWay[_ngcontent-%COMP%]{border-radius:5px;margin-bottom:4px;text-align:left;display:flex;align-items:center;position:relative;padding:10px 0;border:1px solid #e0e5eb;width:100%}.payment-methods-card[_ngcontent-%COMP%]   .btn-payWay[_ngcontent-%COMP%]:after{display:block;content:">";position:absolute;line-height:40px;right:8px;top:0;color:#ccc}.payment-methods-card[_ngcontent-%COMP%]   .btn-payWay[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]{height:24px;margin-left:12px}.payment-methods-card[_ngcontent-%COMP%]   .btn-pay[_ngcontent-%COMP%]{margin-top:16px;color:#fff;border-color:#fb8811;background:#fb8811;text-shadow:0 -1px 0 rgba(0,0,0,.12);box-shadow:0 2px rgba(0,0,0,.043);width:100%;height:40px;padding:6.4px 15px;font-size:16px;border-radius:5px!important}.payment-methods-card[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{color:#858a8e;font-size:20px;margin-top:16px}.payment-methods-card[_ngcontent-%COMP%]   .amount-value[_ngcontent-%COMP%]{font-weight:700;font-size:24px}']}),r})();const St=["methodsCard"],At=["methodsCrypto"];function It(r,o){if(1&r){const e=t.EpF();t.O4$(),t.kcU(),t.TgZ(0,"div",11)(1,"div",12)(2,"div",13),t._uU(3),t.ALo(4,"translate"),t.qZA(),t.TgZ(5,"div"),t._uU(6),t.ALo(7,"currency"),t.qZA()(),t._UZ(8,"div",14),t.TgZ(9,"div",15),t._uU(10),t.ALo(11,"translate"),t.qZA(),t.TgZ(12,"button",16),t.NdJ("click",function(){t.CHM(e);const a=t.oxw(2);return a.showPaymentCrypto=!0,t.KtG(a.showPaymentCard=!1)}),t.TgZ(13,"div",17)(14,"div",18),t._uU(15),t.ALo(16,"translate"),t.qZA(),t._UZ(17,"img",19),t.qZA()(),t.TgZ(18,"button",20),t.NdJ("click",function(){t.CHM(e);const a=t.oxw(2);return a.showPaymentCard=!0,t.KtG(a.showPaymentCrypto=!1)}),t.TgZ(19,"div",17)(20,"div",18),t._uU(21),t.ALo(22,"translate"),t.qZA(),t.TgZ(23,"div",21),t._UZ(24,"img",22)(25,"img",23)(26,"img",24),t.qZA()()(),t._UZ(27,"div"),t.qZA()}if(2&r){const e=t.oxw(2);t.xp6(3),t.Oqu(t.lcZ(4,5,"total")),t.xp6(3),t.Oqu(t.lcZ(7,7,e.amount)),t.xp6(4),t.Oqu(t.lcZ(11,9,"checkout-select-payment-methods")),t.xp6(5),t.hij(" ",t.lcZ(16,11,"checkout-payment-methods-crypto")," "),t.xp6(6),t.hij(" ",t.lcZ(22,13,"checkout-payment-methods-card")," ")}}function Zt(r,o){if(1&r&&(t.O4$(),t.kcU(),t._UZ(0,"app-payment-methods-card",25,26)),2&r){const e=t.oxw(2);t.Q6J("businessId",e.orderId)("businessType",e.PayBusinessType.AGGREGATE)("amount",e.amount)("successCallbackUrl",e.successCallbackUrl)("errorCallbackUrl",e.errorCallbackUrl)}}function Ut(r,o){if(1&r&&(t.O4$(),t.kcU(),t._UZ(0,"app-payment-methods-crypto",25,27)),2&r){const e=t.oxw(2);t.Q6J("businessId",e.orderId)("businessType",e.PayBusinessType.AGGREGATE)("amount",e.amount)("successCallbackUrl",e.successCallbackUrl)("errorCallbackUrl",e.errorCallbackUrl)}}function kt(r,o){if(1&r){const e=t.EpF();t.TgZ(0,"div",3)(1,"div",4),t.GkF(2,5),t._uU(3),t.ALo(4,"translate"),t.qZA(),t.TgZ(5,"button",6),t.NdJ("click",function(){t.CHM(e),t.oxw();const a=t.MAs(1);return t.KtG(a.dismiss())}),t.O4$(),t.TgZ(6,"svg",7),t._UZ(7,"path",8),t.qZA()()(),t.YNc(8,It,28,15,"div",9),t.YNc(9,Zt,2,5,"app-payment-methods-card",10),t.YNc(10,Ut,2,5,"app-payment-methods-crypto",10)}if(2&r){const e=t.oxw(),n=t.MAs(4);t.xp6(2),t.Q6J("ngTemplateOutlet",n),t.xp6(1),t.hij(" ",t.lcZ(4,5,"confirm-payment")," "),t.xp6(5),t.Q6J("ngIf",!e.showPaymentCard&&!e.showPaymentCrypto),t.xp6(1),t.Q6J("ngIf",e.showPaymentCard),t.xp6(1),t.Q6J("ngIf",e.showPaymentCrypto)}}function Mt(r,o){if(1&r){const e=t.EpF();t.O4$(),t.TgZ(0,"svg",28),t.NdJ("click",function(){t.CHM(e);const a=t.oxw(),p=t.MAs(1);return t.KtG(a.handleBack(p))}),t.TgZ(1,"g")(2,"g",29),t._UZ(3,"path",30),t.qZA()()()}}let Lt=(()=>{class r{constructor(e,n,a){this.checkoutService=e,this.userService=n,this.strategyService=a,this.showPtCrypto=!1,this.showPtCard=!1,this.isOpenChange=new t.vpe,this.amount=0,this.back=new t.vpe,this.type="",this.orderId=0,this.successCallbackUrl="",this.errorCallbackUrl="",this.showPaymentCard=!1,this.showPaymentCrypto=!1,this.paymentMethodsEnum=c.Lt,this.payWayList=[],this.show=!1,this.PayBusinessType=c.ri,this.paymentPlatform=c.fS.TRIPLE}ngOnInit(){return(0,b.mG)(this,void 0,void 0,function*(){})}ngOnChanges(e){e.showPtCrypto&&(this.showPaymentCrypto=e.showPtCrypto.currentValue),e.showPtCard&&(this.showPaymentCard=e.showPtCard.currentValue)}handleBack(e){return(0,b.mG)(this,void 0,void 0,function*(){yield e.dismiss(),this.showPaymentCard=!1,this.showPaymentCrypto=!1,this.back.emit()})}showCard(){setTimeout(()=>{this.showPaymentCard=!0,this.showPaymentCrypto=!1},1e3)}showCrypto(){setTimeout(()=>{this.showPaymentCrypto=!0,this.showPaymentCard=!1},1e3)}payWithCard(){this.showPaymentCrypto=!1,this.showPaymentCard=!0}payWithCrypto(){this.showPaymentCard=!1,this.showPaymentCrypto=!0}}return r.\u0275fac=function(e){return new(e||r)(t.Y36(Z.Z),t.Y36(m.K),t.Y36(ct.k))},r.\u0275cmp=t.Xpm({type:r,selectors:[["app-payment-method-modal"]],viewQuery:function(e,n){if(1&e&&(t.Gf(St,5),t.Gf(At,5)),2&e){let a;t.iGM(a=t.CRH())&&(n.methodsCard=a.first),t.iGM(a=t.CRH())&&(n.methodsCrypto=a.first)}},inputs:{showPtCrypto:"showPtCrypto",showPtCard:"showPtCard",isOpen:"isOpen",accounts:"accounts",amount:"amount",type:"type",paymentStrategy:"paymentStrategy",orderId:"orderId",successCallbackUrl:"successCallbackUrl",errorCallbackUrl:"errorCallbackUrl"},outputs:{isOpenChange:"isOpenChange",back:"back"},features:[t.TTD],decls:5,vars:2,consts:[[3,"backdropDismiss","isOpen","didDismiss"],["modal",""],["backIcon",""],[1,"flex","items-center","p-2"],[1,"flex-1","font-bold","text-3xl","flex","items-center"],[3,"ngTemplateOutlet"],[1,"w-8","p-1","rounded","cursor-pointer","bg-[#ff2145]","text-white",3,"click"],["version","1.1","viewBox","0 0 100 100","overflow","visible","enable-background","new 0 0 100 100"],["stroke","currentColor","stroke-width","12","stroke-linecap","square","d","M 10,10 90,90 M 10,90 90,10"],["class","p-4",4,"ngIf"],["style","padding: 10px",3,"businessId","businessType","amount","successCallbackUrl","errorCallbackUrl",4,"ngIf"],[1,"p-4"],[1,"flex","justify-between","font-bold","text-2xl"],[1,"mr-2"],[1,"border-b","border-[#dddddd]","my-2"],[1,"text-center","text-2xl","font-bold"],[1,"w-full","bg-gradient-primary","p-1.5","text-center","text-white","rounded-md","flex","items-center","mb-2",3,"click"],[1,"flex-1","xs:ml-2"],[1,"text-base"],["src","assets/images/payment-crypto-min.png","alt","",1,"h-7","m-auto"],[1,"w-full","bg-gradient-primary","p-1.5","text-center","text-white","rounded-md","flex","items-center",3,"click"],[1,"flex","justify-center","items-center","h-7","overflow-hidden"],["src","assets/images/payment-alipay-white-min.png","alt","",1,"h-6","flex-shrink"],["src","assets/images/payment-wechatpay-white-min.png","alt","",1,"h-6","flex-shrink"],["src","assets/images/payment-vise-master-amex-min.png","alt","",1,"h-6","flex-shrink"],[2,"padding","10px",3,"businessId","businessType","amount","successCallbackUrl","errorCallbackUrl"],["methodsCard",""],["methodsCrypto",""],["xmlns","http://www.w3.org/2000/svg",0,"xmlns","xlink","http://www.w3.org/1999/xlink","version","1.1","id","Capa_1","x","0px","y","0px","viewBox","0 0 384.97 384.97",0,"xml","space","preserve",1,"cursor-pointer","h-10","mr-2",2,"enable-background","new 0 0 384.97 384.97",3,"click"],["id","Chevron_Left_Circle"],["d","M235.878,99.876c-4.704-4.74-12.319-4.74-17.011,0l-83.009,84.2c-4.572,4.62-4.584,12.56,0,17.191l82.997,84.2    c4.704,4.74,12.319,4.74,17.011,0c4.704-4.752,4.704-12.439,0-17.191l-74.528-75.61l74.54-75.61    C240.57,112.315,240.57,104.628,235.878,99.876z"]],template:function(e,n){1&e&&(t.TgZ(0,"ion-modal",0,1),t.NdJ("didDismiss",function(){return n.isOpenChange.emit(!1)}),t.YNc(2,kt,11,7,"ng-template"),t.qZA(),t.YNc(3,Mt,4,0,"ng-template",null,2,t.W1O)),2&e&&t.Q6J("backdropDismiss",!1)("isOpen",n.isOpen)},dependencies:[u.O5,u.tP,y.ki,gt,wt,u.H9,h.X$],styles:["ion-modal[_ngcontent-%COMP%]{--width: 450px;--border-radius: 15px;--height: auto;--background: var(--main-bg);--border-color: var(--main-border);--border-width: 2px;--border-style: solid;--padding: 8px}ion-input[_ngcontent-%COMP%]{--padding-bottom: 0px;--padding-top: 0px}ion-input[_ngcontent-%COMP%]     input{border-radius:0!important}.bg-gradient-primary[_ngcontent-%COMP%]{border-color:#37ff73;background-color:var(--main-green);--tw-text-opacity: 1;color:rgb(255 255 255/var(--tw-text-opacity))}.convert-dollar-btn[_ngcontent-%COMP%]{border-width:2px;border-style:solid;--tw-border-opacity: 1;border-color:rgb(46 213 143 / var(--tw-border-opacity))}button[disabled][_ngcontent-%COMP%]{opacity:.3}"]}),r})();function Et(r,o){1&r&&t._UZ(0,"app-order-item",26),2&r&&t.Q6J("orderItem",o.$implicit)}function Rt(r,o){if(1&r){const e=t.EpF();t.TgZ(0,"button",27),t.NdJ("click",function(){t.CHM(e);const a=t.oxw();return t.KtG(a.payWithBalance())}),t.TgZ(1,"div",19),t._uU(2),t.ALo(3,"translate"),t.qZA()()}2&r&&(t.xp6(2),t.Oqu(t.lcZ(3,1,"complete-checkout")))}function $t(r,o){1&r&&t._UZ(0,"app-loading-spinner",36)}function Bt(r,o){1&r&&t._UZ(0,"app-loading-spinner",36)}function Nt(r,o){if(1&r){const e=t.EpF();t.TgZ(0,"button",28),t.NdJ("click",function(){t.CHM(e);const a=t.oxw();return t.KtG(a.payWithBalance())}),t.YNc(1,$t,1,0,"app-loading-spinner",29),t.TgZ(2,"div"),t._uU(3),t.ALo(4,"translate"),t.qZA(),t.TgZ(5,"div",19),t._uU(6),t.ALo(7,"currency"),t.qZA(),t.TgZ(8,"div",30),t._uU(9),t.ALo(10,"translate"),t.qZA()(),t.TgZ(11,"button",28),t.NdJ("click",function(){t.CHM(e);const a=t.oxw();return t.KtG(a.payWithCard())}),t.YNc(12,Bt,1,0,"app-loading-spinner",29),t.TgZ(13,"div"),t._uU(14),t.ALo(15,"translate"),t.qZA(),t.TgZ(16,"div",31),t._UZ(17,"img",32)(18,"img",33)(19,"img",34),t.qZA(),t.TgZ(20,"div",35),t._uU(21),t.ALo(22,"translate"),t.qZA()()}if(2&r){const e=t.oxw();t.Q6J("disabled",!e.canUseBalance||e.loading.payWithBalance||e.loading.aggregateOrder),t.xp6(1),t.Q6J("ngIf",e.loading.payWithBalance&&e.loading.aggregateOrder),t.xp6(1),t.ekj("invisible",e.loading.payWithBalance&&e.loading.aggregateOrder),t.xp6(1),t.Oqu(t.lcZ(4,19,"pay-using-account-credit")),t.xp6(2),t.ekj("invisible",e.loading.payWithBalance&&e.loading.aggregateOrder),t.xp6(1),t.Oqu(t.lcZ(7,21,e.walletInfo.balance)),t.xp6(2),t.ekj("invisible",e.loading.payWithBalance&&e.loading.aggregateOrder),t.xp6(1),t.Oqu(t.lcZ(10,23,"account-credits-payment-service-fee")),t.xp6(2),t.Q6J("disabled",e.loading.payWithCard||e.loading.aggregateOrder),t.xp6(1),t.Q6J("ngIf",e.loading.payWithCard&&e.loading.aggregateOrder),t.xp6(1),t.ekj("invisible",e.loading.payWithCard&&e.loading.aggregateOrder),t.xp6(1),t.Oqu(t.lcZ(15,25,"pay-using-card")),t.xp6(2),t.ekj("invisible",e.loading.payWithCard&&e.loading.aggregateOrder),t.xp6(5),t.Oqu(t.lcZ(22,27,"card-payment-service-fee"))}}const qt=[{path:"",component:(()=>{class r extends i.H{constructor(e,n,a,p,_,k,M,C,g,f){super(),this.route=e,this.walletService=n,this.checkoutService=a,this.fb=p,this.userService=_,this.vipService=k,this.location=M,this.loadingController=C,this.i18n=g,this.alertController=f,this.orderType=null,this.accountCredits=35.23,this.isOpenPaymentMethodModal=!1,this.showPaymentCard=!1,this.showPaymentCrypto=!1,this.walletInfo={},this.accountCreditsTotal=0,this.subTotal=0,this.loading={aggregateOrder:!1,payWithBalance:!1,payWithCard:!1,payWithCrypto:!1},this.isOpenTradingPINModal=!1,this.step=0,this.businessType=c.ri.AGGREGATE,this.successCallbackUrl="",this.errorCallbackUrl="",this.IOrderStatus=c.vz,this.IPaymentStatus=c.Ri,this.payResultText="",this.payResultIcon="",this.payResultColor="",this.parseOrderParams(),this.getWalletInfo()}ngOnInit(){return(0,b.mG)(this,void 0,void 0,function*(){const e=this.route.snapshot.queryParams;this.orderId=e.orderId,this.businessType=e.businessType,this.orderId&&this.businessType&&(this.queryLoading=yield this.loadingController.create({message:`${this.i18n.instant("Payment results are being checked")}...`}),yield this.queryLoading.present(),this.queryByBusiness())})}get orderItems(){var e;return null===(e=this.orderForm)||void 0===e?void 0:e.controls}get canUseBalance(){return this.walletInfo.balance>=this.subTotal&&this.accountCreditsTotal<=0}handleBack(){const e=this.route.snapshot.queryParamMap.get("back")||"/dashboard";this.router.navigateByUrl(decodeURIComponent(e))}getPassword(e){this.isOpenTradingPINModal=!1,this.password=w()(e),this.payWithBalance()}payWithBalance(){var e;return(0,b.mG)(this,void 0,void 0,function*(){const n=null===(e=this.userService.userInfo$.value)||void 0===e?void 0:e.paymentPassword;if(this.password||!n){this.loading.aggregateOrder=!0,this.loading.payWithBalance=!0;try{const a=yield this.aggregateOrder();Object.is(a.code,0)&&(this.orderId=a.data.id,this.checkoutService.balancePay(Object.assign({businessType:this.businessType,businessId:this.orderId.toString()},n?{paymentPassword:this.password}:{})).subscribe(p=>{Object.is(p.code,0)?(this.toast.toastSuccess(this.i18n.instant("payment-successful")),this.handlePaymentSuccess(this.finalGoodsList)):this.toast.toastError(p.message)}).add(()=>this.loading.payWithBalance=!1))}catch(a){console.error(a)}finally{this.loading.aggregateOrder=!1}}else this.isOpenTradingPINModal=!0})}aggregateOrder(){return(0,b.mG)(this,void 0,void 0,function*(){this.businessType=c.ri.AGGREGATE;const e=this.orderItems.map(g=>g.value),n=e.reduce((g,f)=>Object.is(f.type,s.yh.Strategy)||Object.is(f.type,s.yh.FreeMembership)?g:Object.is(f.type,s.yh.Gift)?(g.push({amount:f.quantity*f.amount,goodsType:f.type,params:{giftAmount:Number(f.amount),giftQuantity:Number(f.quantity)}}),g):(g.push({amount:f.quantity*f.amount,goodsType:f.type,params:f.params||{}}),g),[]),a=e.find(g=>Object.is(g.type,s.yh.FreeMembership));if(a){const g=n.find(f=>Object.is(f.goodsType,s.yh.AcountCredit));g?g.params=a.params:n.push({amount:0,goodsType:s.yh.AcountCredit,params:a.params})}const p=n.reduce((g,f)=>g+f.amount,0);let _={code:"",data:{}};Object.is(e.length,2)&&e.some(g=>Object.is(g.type,s.yh.FreeMembership))?(this.businessType=c.ri.VIP,_=yield(0,T.n)(this.vipService.buyVip({vipId:3,automaticActivation:!1}))):_=yield(0,T.n)(this.userService.aggregateOrder({amount:p,goodsList:n})),this.finalGoodsList=n;const{orderData:M,back:C}=this.route.snapshot.queryParams;return this.successCallbackUrl=`/confirm-order?orderData=${M}&back=${C}&orderId=${_.data.id}&businessType=${this.businessType}`,Promise.resolve(_)})}parseOrderParams(){this.route.queryParams.pipe((0,E.R)(this.onDestroy$)).subscribe(e=>{let n=[];e.orderData&&(n=JSON.parse(decodeURI(e.orderData)),n.some(a=>a.type===s.yh.AcountCredit)&&1==n.length?this.orderType=s.mr.Deposit:n.some(a=>a.type===s.yh.Strategy)&&(this.orderType=s.mr.Strategy)),this.buildOrderForm(n)})}buildOrderForm(e){this.orderForm=this.fb.array([]),e.forEach(n=>{this.orderForm.push(this.getOrderItemFormGroup(n))}),this.calculateTotals(),this.orderForm.valueChanges.pipe((0,E.R)(this.onDestroy$)).subscribe(()=>{this.calculateTotals()})}calculateTotals(){this.subTotal=this.orderItems.reduce((n,a)=>n+a.get("quantity").value*a.get("amount").value,0);const e=this.orderItems.find(n=>n.get("type").value===s.yh.AcountCredit);e&&(this.accountCreditsTotal=e.get("quantity").value*e.get("amount").value)}getOrderItemFormGroup(e){return this.fb.group({type:[e.type],amount:[e.amount],quantity:[e.quantity],minQuantity:[e.minQuantity],minAmount:[e.minAmount],amountStepBy:[e.amountStepBy],originalAmount:[e.originalAmount],name:[e.name],amountReadOnly:[e.type!==s.yh.Gift],quantityReadOnly:[e.type===s.yh.FreeMembership||e.type===s.yh.Strategy],params:[e.params]})}getWalletInfo(){this.walletService.walletInfo().pipe().subscribe(e=>(0,b.mG)(this,void 0,void 0,function*(){0!==e.code||(this.walletInfo=e.data)}))}payWithCrypto(){return(0,b.mG)(this,void 0,void 0,function*(){this.loading.aggregateOrder=!0,this.loading.payWithCrypto=!0;try{const e=yield this.aggregateOrder();Object.is(e.code,0)&&(this.orderId=e.data.id,this.showPaymentCard=!1,this.isOpenPaymentMethodModal=!0,this.showPaymentCrypto=!0)}catch(e){console.error(e)}finally{this.loading.aggregateOrder=!1,this.loading.payWithCrypto=!1}})}payWithCard(){return(0,b.mG)(this,void 0,void 0,function*(){this.loading.aggregateOrder=!0,this.loading.payWithCard=!0;try{const e=yield this.aggregateOrder();Object.is(e.code,0)&&(this.orderId=e.data.id,this.showPaymentCrypto=!1,this.showPaymentCard=!0,this.isOpenPaymentMethodModal=!0)}catch(e){console.error(e)}finally{this.loading.aggregateOrder=!1,this.loading.payWithCard=!1}})}queryOrderDetail(){this.userService.queryOrderDetail(this.orderId).subscribe(e=>{if(!Object.is(e.code,0))return void this.toast.toastError(e.message);this.orderDetails=e.data;const n=this.orderDetails.orderItem.map(a=>Object.assign(Object.assign({},a),{params:this.parseJSON(a.params||"{}")}));this.handlePaymentSuccess(n)})}parseJSON(e){try{return JSON.parse(e)}catch(n){return{}}}handlePaymentSuccess(e){var n;return(0,b.mG)(this,void 0,void 0,function*(){yield null===(n=this.queryLoading)||void 0===n?void 0:n.dismiss();const a=e.find(C=>Object.is(C.goodsType,s.yh.HashPower));if(a&&a.params.isActivateStrategy){const{realId:C,accounts:g,riskControls:f}=a.params;return void this.userService.strategyActivate({realId:C,accounts:JSON.parse(g),riskControls:JSON.parse(f)}).subscribe(()=>{this.router.navigate(["dashboard"],{queryParams:{id:C}})})}let p=0;a&&(p=4),e.find(C=>{var g;return Object.is(C.goodsType,s.yh.AcountCredit)&&(null===(g=C.params)||void 0===g?void 0:g.isBuyVip)})?this.router.navigate(["settings","membership"]):(e.find(C=>Object.is(C.goodsType,s.yh.Gift))&&(p=3),e.find(C=>Object.is(C.goodsType,s.yh.AcountCredit))&&(p=1),this.router.navigate(["settings","my-wallet"],{queryParams:{openTab:p}}))})}queryByBusiness(){this.checkoutService.queryByBusiness(this.businessType,this.orderId).subscribe(e=>(0,b.mG)(this,void 0,void 0,function*(){if(Object.is(e.code,0)){if(!Object.is(e.data.status,c.Ri.Waiting))return this.paymentDetails=e.data,[c.Ri.Fail,c.Ri.Expire].includes(this.paymentDetails.status)?(yield(yield this.alertController.create({header:this.i18n.instant("payment-fail"),message:this.i18n.instant("Please re-pay"),buttons:[this.i18n.instant("close")]})).present(),void(yield this.queryLoading.dismiss())):(this.toast.toastSuccess(this.i18n.instant("payment-successful")),void this.queryOrderDetail());setTimeout(this.queryOrderDetail,500)}else this.toast.toastError(this.i18n.instant(e.message))}))}}return r.\u0275fac=function(e){return new(e||r)(t.Y36(U.gz),t.Y36(P.X),t.Y36(Z.Z),t.Y36(d.qu),t.Y36(m.K),t.Y36(A.s),t.Y36(u.Ye),t.Y36(y.HT),t.Y36(h.sK),t.Y36(y.Br))},r.\u0275cmp=t.Xpm({type:r,selectors:[["app-confirm-order"]],features:[t.qOj],decls:50,vars:43,consts:[[3,"fullscreen"],[1,"confirm-page-container","flex","flex-wrap","font-medium","px-2","py-4","lg:pt-16","xl:pt-24","2xl:pt-32"],[1,"w-full","lg:w-7/12","mt-2","mb-5","lg:my-2","lg:pr-4"],[1,"border","border-main-border","order-details","rounded-xl","px-3","py-2"],[1,"text-text-strong","flex","text-3xl","capitalize"],[1,"border-b","border-main-border","mt-2","mb-3"],[3,"orderItem",4,"ngFor","ngForOf"],[1,"flex","items-center","text-2xl","text-text-strong"],[1,"flex-1","capitalize"],[1,"w-full","lg:w-5/12","my-2"],[1,"border","border-main-border","order-details","rounded-xl","px-3","py-2","text-xl"],[1,"flex","items-center"],[1,"flex-1","text-3xl","text-text-strong","capitalize"],[1,"border-b","border-main-border","mt-2","mb-2"],[1,"flex","items-center","text-xl"],[1,"flex-1","text-text-strong","capitalize"],[1,"border-b","border-main-border","my-2"],[1,"flex","items-center","text-xl","text-text-strong"],[1,"flex-1","text-2xl","capitalize"],[1,"text-2xl"],[1,"mt-6","mb-32","sm:mb-24","lg:my-3"],[1,"text-2xl","text-text-strong","text-center","mb-6","lg:mb-2","capitalize"],["class","payment-btn w-full text-xl mb-2 capitalize",3,"click",4,"ngIf","ngIfElse"],[3,"type","orderId","showPtCrypto","showPtCard","amount","isOpen","successCallbackUrl","errorCallbackUrl","isOpenChange"],["paymentOptions",""],[3,"step","isOpen","payment","isOpenChange","notifyParentEvent"],[3,"orderItem"],[1,"payment-btn","w-full","text-xl","mb-2","capitalize",3,"click"],[1,"payment-btn","w-full","text-xl","mb-3","lg:mb-2","capitalize","py-1.5","relative",3,"disabled","click"],["class","text-grey-2 absolute left-1/2 top-1/2 transform -translate-x-1/2 -translate-y-1/2","size","30px","thick","3px",4,"ngIf"],[1,"text-right","font-bold","text-base","mr-4","-mt-1.5"],[1,"flex","justify-center"],["src","assets/images/payment-alipay-dark-min.png","alt","",1,"h-5","sm:h-6"],["src","assets/images/payment-wechatpay-dark-min.png","alt","",1,"h-5","sm:h-6"],["src","assets/images/payment-vise-master-amex-min.png","alt","",1,"h-5","sm:h-6"],[1,"text-right","font-bold","text-base","mr-4","mt-1"],["size","30px","thick","3px",1,"text-grey-2","absolute","left-1/2","top-1/2","transform","-translate-x-1/2","-translate-y-1/2"]],template:function(e,n){if(1&e&&(t.TgZ(0,"ion-content",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4),t._UZ(5,"app-top-back-button"),t._uU(6),t.ALo(7,"translate"),t.qZA(),t._UZ(8,"div",5),t.YNc(9,Et,1,1,"app-order-item",6),t.TgZ(10,"div",7)(11,"div",8),t._uU(12),t.ALo(13,"translate"),t.qZA(),t.TgZ(14,"div"),t._uU(15),t.ALo(16,"currency"),t.qZA()()()(),t.TgZ(17,"div",9)(18,"div",10)(19,"div",11)(20,"div",12),t._uU(21),t.ALo(22,"translate"),t.qZA(),t.TgZ(23,"div"),t._uU(24),t.qZA()(),t._UZ(25,"div",13),t.TgZ(26,"div",14)(27,"div",15),t._uU(28),t.ALo(29,"translate"),t.qZA(),t.TgZ(30,"div"),t._uU(31),t.ALo(32,"currency"),t.qZA()(),t._UZ(33,"div",16),t.TgZ(34,"div",17)(35,"div",18),t._uU(36),t.ALo(37,"translate"),t.qZA(),t.TgZ(38,"div",19),t._uU(39),t.ALo(40,"currency"),t.qZA()()(),t.TgZ(41,"div",20)(42,"div",21),t._uU(43),t.ALo(44,"translate"),t.qZA(),t.YNc(45,Rt,4,3,"button",22),t.qZA()()()(),t.TgZ(46,"app-payment-method-modal",23),t.NdJ("isOpenChange",function(p){return n.isOpenPaymentMethodModal=p}),t.qZA(),t.YNc(47,Nt,23,29,"ng-template",null,24,t.W1O),t.TgZ(49,"app-trading-password-modal",25),t.NdJ("isOpenChange",function(p){return n.isOpenTradingPINModal=p})("notifyParentEvent",function(p){return n.getPassword(p)}),t.qZA()),2&e){const a=t.MAs(48);t.Q6J("fullscreen",!0),t.xp6(6),t.hij(" ",t.lcZ(7,25,"confirm-order")," "),t.xp6(3),t.Q6J("ngForOf",n.orderItems),t.xp6(3),t.Oqu(t.lcZ(13,27,"subtotal")),t.xp6(3),t.Oqu(t.lcZ(16,29,n.subTotal)),t.xp6(6),t.Oqu(t.lcZ(22,31,"order-total")),t.xp6(3),t.hij("",n.orderItems.length," Items"),t.xp6(4),t.Oqu(t.lcZ(29,33,"subtotal")),t.xp6(3),t.Oqu(t.lcZ(32,35,n.subTotal)),t.xp6(5),t.Oqu(t.lcZ(37,37,"total")),t.xp6(3),t.Oqu(t.lcZ(40,39,n.subTotal)),t.xp6(4),t.hij(" ",t.lcZ(44,41,"select-payment-method")," "),t.xp6(2),t.Q6J("ngIf",0===n.subTotal)("ngIfElse",a),t.xp6(1),t.Q6J("type",n.orderType)("orderId",n.orderId)("showPtCrypto",n.showPaymentCrypto)("showPtCard",n.showPaymentCard)("amount",1.09*n.subTotal)("isOpen",n.isOpenPaymentMethodModal)("successCallbackUrl",n.successCallbackUrl)("errorCallbackUrl",n.errorCallbackUrl),t.xp6(3),t.Q6J("step",n.step)("isOpen",n.isOpenTradingPINModal)("payment",!0)}},dependencies:[u.sg,u.O5,y.W2,F,Y.T,B.i,lt,Lt,u.H9,h.X$],styles:[".confirm-page-container[_ngcontent-%COMP%]{width:1200px;max-width:100%;margin:auto}.payment-btn[_ngcontent-%COMP%]{background:linear-gradient(to right,#FEDF3C,#FFDF2B);border-radius:.375rem;--tw-text-opacity: 1;color:rgb(0 0 0 / var(--tw-text-opacity));min-height:80px}  .dark-mode .confirm-page-container .order-details{background-color:#212139}  .dark-mode .confirm-page-container .payment-btn:disabled{background:#35364e;color:#7e7f96;opacity:1}  .light-mode .confirm-page-container .order-details{--tw-bg-opacity: 1;background-color:rgb(255 255 255 / var(--tw-bg-opacity))}  .light-mode .confirm-page-container .payment-btn:disabled{background:#6d6e83;--tw-text-opacity: 1;color:rgb(255 255 255 / var(--tw-text-opacity))}"]}),r})()}];let jt=(()=>{class r{}return r.\u0275fac=function(e){return new(e||r)},r.\u0275mod=t.oAB({type:r}),r.\u0275inj=t.cJS({imports:[U.Bz.forChild(qt),U.Bz]}),r})(),Wt=(()=>{class r{}return r.\u0275fac=function(e){return new(e||r)},r.\u0275mod=t.oAB({type:r}),r.\u0275inj=t.cJS({imports:[u.ez,d.u5,d.UX,y.Pc,jt,x.x,h.aw,v.kb,I.T,L.Q,N.E,B.i]}),r})()},6832:($,S,l)=>{l.d(S,{r:()=>d});var u=l(4650);let d=(()=>{class y{}return y.\u0275fac=function(v){return new(v||y)},y.\u0275cmp=u.Xpm({type:y,selectors:[["app-check-circle"]],decls:5,vars:0,consts:[["xmlns","http://www.w3.org/2000/svg",0,"xmlns","xlink","http://www.w3.org/1999/xlink","version","1.1","viewBox","0 0 20 20",1,"fill-current","w-full"],["fill","none","fill-rule","evenodd","id","Page-1","stroke","none","stroke-width","1"],["id","Core","transform","translate(-128.000000, -86.000000)",1,"fill-current"],["id","check-circle-outline","transform","translate(128.000000, 86.000000)"],["d","M5.9,8.1 L4.5,9.5 L9,14 L19,4 L17.6,2.6 L9,11.2 L5.9,8.1 L5.9,8.1 Z M18,10 C18,14.4 14.4,18 10,18 C5.6,18 2,14.4 2,10 C2,5.6 5.6,2 10,2 C10.8,2 11.5,2.1 12.2,2.3 L13.8,0.7 C12.6,0.3 11.3,0 10,0 C4.5,0 0,4.5 0,10 C0,15.5 4.5,20 10,20 C15.5,20 20,15.5 20,10 L18,10 L18,10 Z","id","Shape"]],template:function(v,I){1&v&&(u.O4$(),u.TgZ(0,"svg",0)(1,"g",1)(2,"g",2)(3,"g",3),u._UZ(4,"path",4),u.qZA()()()())},encapsulation:2}),y})()},7011:($,S,l)=>{l.d(S,{k:()=>b});var u=l(655),d=l(2340),y=l(1135),h=l(4004),v=l(8505),I=l(9808),x=l(4128),L=l(4650),U=l(529);let b=(()=>{class T{constructor(i){this.http=i,this.strategies$=new y.X([]),this.currentStrategy$=new y.X(null),this.currentStrategyInternation$=new y.X(null),this.activatedStrategyInfo=new y.X({}),this.checkStrategyActive$=new y.X({IsActivate:!1,IsHashCheck:!1,IsSubCountCheck:!1,IsVipCheck:!1,isInvestCheck:!1,residueInvest:0})}getRealStrategyPageList(i){return this.http.get(`${d.N.BASE_URL}/strategy/getRealStrategyPageList?page=${i.page}&rows=${i.rows}&isLike=${i.isLike}&isSub=${i.isSub}&sortOrder=${i.sortOrder}&sortBy=${i.sortBy}&companyId=${i.companyId}`).pipe((0,h.U)(({data:s})=>s),(0,v.b)(s=>{this.strategies$.next((null==s?void 0:s.rows)||[])}))}queryCustomer(i,s){return this.http.get(`${d.N.BASE_URL}/real/queryCustomer?page=${i}&rows=${s}`)}buyStrategy(i){return this.http.post(`${d.N.BASE_URL}/user/buy/strategy`,i)}queryExtension(i){return this.http.get(`${d.N.BASE_URL}/real/queryExtension?realId=${i}`)}getRealSubscriptionLog(i,s,c){return this.http.get(`${d.N.BASE_URL}/strategy/getRealSubscriptionLog?subscriptionId=${c}&page=${i}&rows=${s}`)}getRealDetailById(i){return this.http.get(`${d.N.BASE_URL}/strategy/getRealDetailById`,{params:{realId:i}}).subscribe(s=>{const c=s.data;this.checkActivate(i).subscribe(O=>{this.checkStrategyActive$.next(O.data)}),this.currentStrategy$.next(Object.assign(Object.assign({},c),{accounts:c.accounts?JSON.parse(c.accounts):[]}))})}getRealStrategyIndexProfitLine(i){let s=`${d.N.BASE_URL}/strategy/getRealStrategyIndexProfitLineDesc?runId=${i.runId}&type=${i.type}&limit=${i.limit}&startDate=${i.startDate}&sellId=${i.sellId}`;return i.endDate&&(s+=`&endDate=${i.endDate}`),this.http.get(s).pipe((0,h.U)(({data:c})=>c))}getRealTrade(i){return this.http.post(`${d.N.BASE_URL}/strategy/getRealTrade`,Object.assign({},i)).pipe((0,h.U)(({data:s})=>s))}getRealCustomLog(i,s=0,c=1e3){return this.http.get(`${d.N.BASE_URL}/strategy/getRealCustomLog?runId=${i}&page=${s}&rows=${c}`)}subStrategyReal(i){return this.http.post(`${d.N.BASE_URL}/strategy/subStrategyReal`,Object.assign({},i)).pipe((0,h.U)(({data:s})=>s))}collectStrategyReal(i){return this.http.post(`${d.N.BASE_URL}/strategy/likeStrategyReal`,Object.assign({},i)).pipe((0,h.U)(({data:s})=>s))}queryMyRealStrategy(i){return this.http.get(`${d.N.BASE_URL}/strategy/queryMyRealStrategy?page=${i.page}&rows=${i.rows}&isLike=${i.isLike}&isSub=${i.isSub}&sortOrder=${i.sortOrder}&sortBy=${i.sortBy}`).pipe((0,h.U)(({data:s})=>s))}querySpecs(i){return this.http.get(`${d.N.BASE_URL}/v2/strategy/querySpecs?sellId=${i}`).pipe((0,h.U)(({data:s})=>s))}queryStrategyLabelList(){return this.http.get(`${d.N.BASE_URL}/v2/strategy/queryStrategyLabelList`).pipe((0,h.U)(({data:i})=>i))}getChartData(i){return this.http.get(`${d.N.BASE_URL}/strategy/getChartData?strategyId=${i}`)}stopStrategy(i){return this.http.post(`${d.N.BASE_URL}/strategy/stopStrategy`,{realId:i}).pipe((0,h.U)(({data:s})=>s))}editRiskControl(i){return this.http.post(`${d.N.BASE_URL}/strategy/editRiskControl`,Object.assign({},i)).pipe((0,h.U)(({data:s})=>s))}myAssets(){return this.http.get(`${d.N.BASE_URL}/strategy/myAssets`)}strategyHandling(i){return this.http.get(`${d.N.BASE_URL}/strategy/queryStrategyErr?runId=${i.runId}`).pipe((0,h.U)(({data:s})=>s))}queryStrategyDetails(i){return this.http.get(`${d.N.BASE_URL}/strategy/queryStrategyDetails?id=${i}`)}checkActivate(i){return this.http.get(`${d.N.BASE_URL}/strategy/checkActivate?sellId=${i}`)}getRealStrategyPageListV2(i,s=!1){return this.http.get(`${d.N.BASE_URL}/v2/strategy/list?page=${i.page}&rows=${i.rows}&isLike=${i.isLike}&isSub=${i.isSub}&sortOrder=${i.sortOrder}&sortBy=${i.sortBy}&companyId=${i.companyId}&language=${i.language}&strategyName=${i.strategyName}&incomeDay=${i.incomeDay}&incomeRatio=${i.incomeRatio}&baseCurrency=${i.baseCurrency}`).pipe((0,h.U)(({data:c})=>c),(0,v.b)(c=>(0,u.mG)(this,void 0,void 0,function*(){var O;if(s){this.strategies$.next((null==c?void 0:c.rows)||[]);for(let w=0;w<(null===(O=null==c?void 0:c.rows)||void 0===O?void 0:O.length);w++){const t=c.rows[w];t.isSub&&this.getActivatedStatusFromStrategyId(t.id)}}})))}getSubInfo(i){return this.http.get(`${d.N.BASE_URL}/v2/strategy/subInfo?sellId=${i}`)}getActivatedStatusFromStrategyId(i){return(0,u.mG)(this,void 0,void 0,function*(){if(this.activatedStrategyInfo.getValue()[i])return this.activatedStrategyInfo.getValue()[i];try{const{data:s}=yield(0,I.n)(this.getSubInfo(i));if(s){const c=yield(0,I.n)(this.queryStrategyDetails(s.subId));if(c.data){const O=this.activatedStrategyInfo.getValue();this.activatedStrategyInfo.next(Object.assign(Object.assign({},O),{[i]:c.data}))}return c.data||null}}catch(s){return null}return null})}getRealStrategyProfitInfoV2(i){return this.http.get(`${d.N.BASE_URL}/v2/strategy/profit?sellId=${i}`)}getRealDetailByIdV2(i,s){return(0,x.D)([this.http.get(`${d.N.BASE_URL}/v2/strategy/detail`,{params:{sellId:i,language:s}}),this.checkActivate(i),this.getSubInfo(i),this.getRealStrategyProfitInfoV2(i)]).subscribe(([c,O,w,t])=>{const P=c.data,Z=O.data,m=w.data,A=t.data;console.log(9898989,m,A),this.checkStrategyActive$.next(Z),this.currentStrategy$.next(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},P),m),{gmtCreate:null!=m&&m.isSub?null==m?void 0:m.subTime:P.gmtCreate,TeamRecommendationStopLoss:P.stopLoss,stopLoss:100*(null==m?void 0:m.stopLoss),teamName:P.company.companyName,companyId:P.company.companyId,companyAvatar:P.company.companyAvatar,dailyProfit:A.dp,maxMd:null!=m&&m.isSub?null==m?void 0:m.md:A.md,pr:A.pr,profitAmount:(null==m?void 0:m.totalProfit)||0,averageProfit:A.ap,runStatus:null==m?void 0:m.status,apr:A.apr}),P.subInfo),{myPr:null==m?void 0:m.pr,myApr:null==m?void 0:m.apr,accounts:P.subInfo.accounts?JSON.parse(P.subInfo.accounts):[],type:"automated"}))})}queryBaseCurrency(){return this.http.get(`${d.N.BASE_URL}/v2/strategy/queryBaseCurrency`)}queryHistoricalProfit(i,s){return this.http.get(`${d.N.BASE_URL}/strategy/queryHistoricalProfit?runId=${i}&strategyType=${s}`)}}return T.\u0275fac=function(i){return new(i||T)(L.LFG(U.eN))},T.\u0275prov=L.Yz7({token:T,factory:T.\u0275fac,providedIn:"root"}),T})()},5548:($,S,l)=>{l.d(S,{s:()=>h});var u=l(2340),d=l(4650),y=l(529);let h=(()=>{class v{constructor(x){this.http=x}queryVip(){return this.http.get(`${u.N.BASE_URL}/user/vip/query`)}modifyAutomaticPayment(x){return this.http.post(`${u.N.BASE_URL}/user/vip/modifyAutomaticPayment`,x)}buyVip(x){return this.http.post(`${u.N.BASE_URL}/user/buy/vip`,x)}}return v.\u0275fac=function(x){return new(x||v)(d.LFG(y.eN))},v.\u0275prov=d.Yz7({token:v,factory:v.\u0275fac,providedIn:"root"}),v})()}}]);