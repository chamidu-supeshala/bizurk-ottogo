"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[4011],{5915:(b,C,i)=>{i.d(C,{q:()=>d});var M=i(655),x=i(6895),a=i(4006),c=i(8008),h=i(3416),u=i(9769),o=i(8854),f=i(7341),t=i(1169),e=i(4650),E=i(6540),_=i(5939),p=i(6065);function s(m,g){if(1&m){const n=e.EpF();e.TgZ(0,"form",1)(1,"div",2)(2,"div",3)(3,"h2",4),e._uU(4),e.ALo(5,"translate"),e.qZA(),e.TgZ(6,"ion-icon",5),e.NdJ("click",function(){e.CHM(n);const l=e.oxw();return e.KtG(l.handleDismiss())}),e.qZA()()(),e.TgZ(7,"div",6)(8,"h4",7),e._uU(9),e.ALo(10,"translate"),e.qZA(),e._UZ(11,"app-password-field",8),e.ALo(12,"translate"),e._UZ(13,"div",9),e.TgZ(14,"h4",7),e._uU(15),e.ALo(16,"translate"),e.qZA(),e._UZ(17,"app-password-field",10),e.ALo(18,"translate"),e._UZ(19,"app-password-field",11),e.ALo(20,"translate"),e.qZA(),e.TgZ(21,"div",12)(22,"button",13),e.NdJ("click",function(){e.CHM(n);const l=e.oxw();return e.KtG(l.handleDismiss())}),e._uU(23),e.ALo(24,"translate"),e.qZA(),e.TgZ(25,"button",14),e.NdJ("click",function(){e.CHM(n);const l=e.oxw();return e.KtG(l.onChangePassword())}),e._uU(26),e.ALo(27,"translate"),e.qZA()()()}if(2&m){const n=e.oxw();e.Q6J("formGroup",n.changePasswordForm),e.xp6(4),e.hij(" ",e.lcZ(5,10,"change-password")," "),e.xp6(5),e.hij(" ",e.lcZ(10,12,"enter-current-password")," "),e.xp6(2),e.s9C("placeholder",e.lcZ(12,14,"current-password")),e.xp6(4),e.hij(" ",e.lcZ(16,16,"enter-new-password")," "),e.xp6(2),e.Q6J("placeholder",e.lcZ(18,18,"new-password")),e.xp6(2),e.s9C("placeholder",e.lcZ(20,20,"confirm-new-password")),e.xp6(4),e.hij(" ",e.lcZ(24,22,"cancel")," "),e.xp6(2),e.Q6J("disabled",n.changePasswordForm.invalid),e.xp6(1),e.hij(" ",e.lcZ(27,24,"confirm")," ")}}let d=(()=>{class m extends f.u{constructor(n,r,l){super(),this.formBuilder=n,this.authService=r,this.userService=l,this.confirmationValidator=P=>P.value?Object.is(P.value,this.changePasswordForm.controls.newPassword.value)?{}:{confirm:!0,error:!0}:{required:!0}}ngOnInit(){this.changePasswordForm=this.formBuilder.group({currentPassword:[null,[a.kI.required]],newPassword:[null,[a.kI.required]],confirmNewPassword:[null,[a.kI.required,this.confirmationValidator]]})}onChangePassword(){const n=this.changePasswordForm.getRawValue();this.authService.modifyPassword({oldPassword:u(n.currentPassword).toString(),newPassword:u(n.confirmNewPassword).toString()}).subscribe(r=>(0,M.mG)(this,void 0,void 0,function*(){0===r.code?(yield this.userService.updateUserInfo(),this.toast.toastSuccess("\u4fee\u6539\u6210\u529f"),setTimeout(()=>{this.handleDismiss()},1500)):this.toast.toastError(r.message)}))}resetForm(){this.changePasswordForm.reset()}}return m.\u0275fac=function(n){return new(n||m)(e.Y36(a.qu),e.Y36(E.e),e.Y36(_.K))},m.\u0275cmp=e.Xpm({type:m,selectors:[["app-change-password-modal"]],standalone:!0,features:[e.qOj,e.jDz],decls:2,vars:1,consts:[[1,"theme-modal",3,"isOpen","willDismiss","didDismiss"],[1,"flex","flex-col","p-2","h-full",3,"formGroup"],[1,"modal-header","flex","flex-col","items-center"],[1,"relative","w-full"],[1,"text-2xl","sm:text-3xl","text-text-strong","font-medium","text-left","sm:text-center","ml-1","sm:ml-0","sm:my-2"],["name","close-outline",1,"absolute","right-0","top-0","w-8","h-8","sm:w-10","sm:h-10","cursor-pointer","sm:m-1",3,"click"],[1,"modal-content","mb-8","px-1","sm:px-3"],[1,"text-text-strong","text-xl","sm:text-2xl","font-medium","ml-1","mb-1.5"],["formControlName","currentPassword",3,"placeholder"],[1,"border-b","border-main-border","mt-5","mb-3","mx-1"],["customInputClass","mb-5","formControlName","newPassword",3,"placeholder"],["formControlName","confirmNewPassword",3,"placeholder"],[1,"modal-footer","flex","justify-between","px-1","sm:px-3"],["appRippleEffect","",1,"btn-medium",3,"click"],["appRippleEffect","",1,"btn-blue","font-medium",3,"disabled","click"]],template:function(n,r){1&n&&(e.TgZ(0,"ion-modal",0),e.NdJ("willDismiss",function(){return r.handleDismiss()})("didDismiss",function(){return r.resetForm()}),e.YNc(1,s,28,26,"ng-template"),e.qZA()),2&n&&e.Q6J("isOpen",r.isOpen)},dependencies:[x.ez,a.u5,a._Y,a.JJ,a.JL,a.UX,a.sg,a.u,h.aw,h.X$,c.Pc,c.gu,c.ki,o.T,p.R,t.b],styles:["ion-modal[_ngcontent-%COMP%]{--width: 480px;--height: auto}.modal-header[_ngcontent-%COMP%]{margin-bottom:.5rem}@media (min-width: 640px){.modal-header[_ngcontent-%COMP%]{margin-bottom:.85rem}}.modal-content[_ngcontent-%COMP%]{margin-bottom:1.1rem}@media (min-width: 640px){.modal-content[_ngcontent-%COMP%]{margin-bottom:1.6rem}}.modal-footer[_ngcontent-%COMP%]{margin-bottom:.35rem}@media (min-width: 640px){.modal-footer[_ngcontent-%COMP%]{margin-bottom:.85rem}}.modal-footer[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{height:3rem;width:8rem;border-radius:.375rem;border-width:1px;border-style:solid;font-size:1.25rem;line-height:1.75rem}@media (min-width: 640px){.modal-footer[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{height:3.5rem;width:11rem;font-size:1.5rem;line-height:2rem}}"]}),m})()},2738:(b,C,i)=>{i.d(C,{T:()=>E});var M=i(655),x=i(6895),a=i(4006),c=i(8008),h=i(3416),u=i(8854),v=i(7341),o=i(4650),f=i(6540),t=i(5939);function e(_,p){if(1&_){const s=o.EpF();o.TgZ(0,"form",1)(1,"div",2)(2,"div",3)(3,"h2",4),o._uU(4),o.ALo(5,"translate"),o.qZA(),o.TgZ(6,"ion-icon",5),o.NdJ("click",function(){o.CHM(s);const m=o.oxw();return o.KtG(m.handleDismiss())}),o.qZA()()(),o.TgZ(7,"div",6)(8,"div",7)(9,"div",8),o._UZ(10,"ion-input",9),o.ALo(11,"translate"),o.qZA()(),o.TgZ(12,"div",7)(13,"div",8),o._UZ(14,"ion-input",10),o.ALo(15,"translate"),o.qZA(),o.TgZ(16,"button",11),o.NdJ("click",function(){o.CHM(s);const m=o.oxw();return o.KtG(m.getEmailCode())}),o._uU(17),o.ALo(18,"translate"),o.qZA()()(),o.TgZ(19,"div",12)(20,"button",13),o.NdJ("click",function(){o.CHM(s);const m=o.oxw();return o.KtG(m.handleDismiss())}),o._uU(21),o.ALo(22,"translate"),o.qZA(),o.TgZ(23,"button",14),o.NdJ("click",function(){o.CHM(s);const m=o.oxw();return o.KtG(m.onChangePhoneNumber())}),o._uU(24),o.ALo(25,"translate"),o.qZA()()()}if(2&_){const s=o.oxw();o.Q6J("formGroup",s.changePhoneNumberForm),o.xp6(4),o.hij(" ",o.lcZ(5,9,"set-up-email")," "),o.xp6(6),o.s9C("placeholder",o.lcZ(11,11,"email")),o.xp6(4),o.s9C("placeholder",o.lcZ(15,13,"verification-code")),o.xp6(2),o.Q6J("disabled",s.changePhoneNumberForm.controls.email.invalid||s.smsTimeRemaining>0),o.xp6(1),o.hij(" ",o.lcZ(18,15,"get-verification-code")," "),o.xp6(4),o.hij(" ",o.lcZ(22,17,"cancel")," "),o.xp6(2),o.Q6J("disabled",s.changePhoneNumberForm.invalid),o.xp6(1),o.hij(" ",o.lcZ(25,19,"confirm")," ")}}let E=(()=>{class _ extends v.u{constructor(s,d,m){super(),this.formBuilder=s,this.authService=d,this.userService=m,this.smsTimeRemaining=0}ngOnInit(){this.changePhoneNumberForm=this.formBuilder.group({email:[null,[a.kI.required]],verificationCode:[null,[a.kI.required]]})}onPhoneNumberChange(s){var d;null===(d=this.changePhoneNumberForm.get("phoneNumber"))||void 0===d||d.patchValue(s)}onChangePhoneNumber(){if(this.changePhoneNumberForm.invalid)return;const s=this.changePhoneNumberForm.getRawValue();this.authService.bindEmail({email:s.email,emailCode:s.verificationCode}).subscribe(d=>(0,M.mG)(this,void 0,void 0,function*(){0===d.code?(yield this.userService.updateUserInfo(),this.toast.toastSuccess("\u4fee\u6539\u6210\u529f"),this.handleDismiss()):this.toast.toastError(d.message)}))}startTimeInterval(){this.timeInterval=setInterval(()=>{this.smsTimeRemaining-=1,this.smsTimeRemaining<1&&clearInterval(this.timeInterval)},1e3)}getEmailCode(){if(!this.changePhoneNumberForm.controls.email.valid)return this.changePhoneNumberForm.controls.email.markAsDirty(),void this.changePhoneNumberForm.controls.email.updateValueAndValidity({onlySelf:!0});this.authService.SendEmailVerifyCodeParam({email:this.changePhoneNumberForm.value.email,type:"modifyEmail"}).subscribe(s=>{console.log(s),1001006!==s.code?(this.toast.toastSuccess("\u90ae\u4ef6\u5df2\u53d1\u9001"),this.smsTimeRemaining=60):this.toast.toastError("\u90ae\u7bb1\u5df2\u5b58\u5728")})}}return _.\u0275fac=function(s){return new(s||_)(o.Y36(a.qu),o.Y36(f.e),o.Y36(t.K))},_.\u0275cmp=o.Xpm({type:_,selectors:[["app-edit-email-modal"]],standalone:!0,features:[o.qOj,o.jDz],decls:2,vars:1,consts:[[1,"theme-modal",3,"isOpen","didDismiss"],[1,"flex","flex-col","p-2","h-full",3,"formGroup"],[1,"modal-header","flex","flex-col","items-center"],[1,"relative","w-full"],[1,"text-2xl","sm:text-3xl","text-text-strong","font-medium","text-left","sm:text-center","ml-1","sm:ml-0","sm:my-2"],["name","close-outline",1,"absolute","right-0","top-0","w-8","h-8","sm:w-10","sm:h-10","m-1","cursor-pointer",3,"click"],[1,"modal-content","px-1","sm:px-3"],[1,"sms-field","flex","w-full"],[1,"flex","flex-auto","items-center","bg-bg-input","rounded-l-lg","border","border-border-input","text-text-strong","text-xl"],["formControlName","email","required","",1,"sms-code",3,"placeholder"],["formControlName","verificationCode","required","",1,"sms-code",3,"placeholder"],[1,"btn-blue","sms-btn","border","border-border-input","rounded-r-lg","font-medium","text-text-strong","p-3","whitespace-nowrap",3,"disabled","click"],[1,"modal-footer","flex","justify-between","px-1","sm:px-3"],[1,"btn-medium","text-text-strong",3,"click"],[1,"btn-blue","font-medium",3,"disabled","click"]],template:function(s,d){1&s&&(o.TgZ(0,"ion-modal",0),o.NdJ("didDismiss",function(){return d.handleDismiss()}),o.YNc(1,e,26,21,"ng-template"),o.qZA()),2&s&&o.Q6J("isOpen",d.isOpen)},dependencies:[x.ez,a.u5,a._Y,a.JJ,a.JL,a.Q7,a.UX,a.sg,a.u,h.aw,h.X$,c.Pc,c.gu,c.pK,c.ki,c.j9,u.T],styles:["ion-modal[_ngcontent-%COMP%]{--width: 480px;--height: auto;--overflow: visible}ion-modal[_ngcontent-%COMP%]     .ion-page{overflow:visible}ion-input[_ngcontent-%COMP%]{--placeholder-color: var(--input-placeholder);--placeholder-font-weight: 500;--padding-top: 4px;--padding-bottom: 4px}ion-input.sms-code[_ngcontent-%COMP%]{--padding-start: 10px}.sms-field[_ngcontent-%COMP%]{margin-top:1.2rem}@media (min-width: 640px){.sms-field[_ngcontent-%COMP%]{margin-top:1.7rem}}.sms-btn[_ngcontent-%COMP%]{font-size:1.16rem}.modal-header[_ngcontent-%COMP%]{margin-bottom:.5rem}@media (min-width: 640px){.modal-header[_ngcontent-%COMP%]{margin-bottom:.85rem}}.modal-content[_ngcontent-%COMP%]{margin-bottom:1.1rem}@media (min-width: 640px){.modal-content[_ngcontent-%COMP%]{margin-bottom:1.6rem}}.modal-footer[_ngcontent-%COMP%]{margin-bottom:.35rem}@media (min-width: 640px){.modal-footer[_ngcontent-%COMP%]{margin-bottom:.85rem}}.modal-footer[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{height:3rem;width:8rem;border-radius:.375rem;border-width:1px;border-style:solid;font-size:1.25rem;line-height:1.75rem}@media (min-width: 640px){.modal-footer[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{height:3.5rem;width:11rem;font-size:1.5rem;line-height:2rem}}"]}),_})()},3366:(b,C,i)=>{i.d(C,{N:()=>d});var M=i(655),x=i(6895),a=i(4006),c=i(8008),h=i(3416),u=i(8854),v=i(1075),o=i(7341),f=i(7312),t=i(4650),e=i(6540),E=i(5939),_=i(6948),p=i(6065);function s(m,g){if(1&m){const n=t.EpF();t.TgZ(0,"form",1)(1,"div",2)(2,"div",3)(3,"h2",4),t._uU(4),t.ALo(5,"translate"),t.qZA(),t.TgZ(6,"ion-icon",5),t.NdJ("click",function(){t.CHM(n);const l=t.oxw();return t.KtG(l.handleDismiss())}),t.qZA()()(),t.TgZ(7,"div",6)(8,"app-phone-control",7),t.NdJ("onSelectPhoneCountry",function(l){t.CHM(n);const P=t.oxw();return t.KtG(P.onSelectPhoneCountry(l))})("onPhoneNumberChange",function(l){t.CHM(n);const P=t.oxw();return t.KtG(P.onPhoneNumberChange(l))}),t.qZA(),t.TgZ(9,"div",8)(10,"div",9),t._UZ(11,"ion-input",10),t.ALo(12,"translate"),t.qZA(),t.TgZ(13,"button",11),t.NdJ("click",function(){t.CHM(n);const l=t.oxw();return t.KtG(l.onSendVerificationCode())}),t._uU(14),t.ALo(15,"translate"),t.qZA()()(),t.TgZ(16,"div",12)(17,"button",13),t.NdJ("click",function(){t.CHM(n);const l=t.oxw();return t.KtG(l.handleDismiss())}),t._uU(18),t.ALo(19,"translate"),t.qZA(),t.TgZ(20,"button",14),t.NdJ("click",function(){t.CHM(n);const l=t.oxw();return t.KtG(l.onChangePhoneNumber())}),t._uU(21),t.ALo(22,"translate"),t.qZA()()()}if(2&m){const n=t.oxw();t.Q6J("formGroup",n.changePhoneNumberForm),t.xp6(4),t.hij(" ",t.lcZ(5,8,"set-up-phone-number")," "),t.xp6(7),t.s9C("placeholder",t.lcZ(12,10,"verification-code")),t.xp6(2),t.Q6J("disabled",n.changePhoneNumberForm.controls.phoneNumber.invalid||n.smsTimeRemaining>0),t.xp6(1),t.hij(" ",n.smsTimeRemaining>0?n.smsTimeRemaining:t.lcZ(15,12,"get-sms-code")," "),t.xp6(4),t.hij(" ",t.lcZ(19,14,"cancel")," "),t.xp6(2),t.Q6J("disabled",n.changePhoneNumberForm.invalid),t.xp6(1),t.hij(" ",t.lcZ(22,16,"confirm")," ")}}let d=(()=>{class m extends o.u{constructor(n,r,l){super(),this.formBuilder=n,this.authService=r,this.userService=l,this.smsTimeRemaining=0}ngOnInit(){this.changePhoneNumberForm=this.formBuilder.group({countryCode:["+86",[a.kI.required]],phoneNumber:[null],verificationCode:[null,[a.kI.required]]})}onSelectPhoneCountry(n){var r;n&&(null===(r=this.changePhoneNumberForm.get("countryCode"))||void 0===r||r.patchValue(n))}onPhoneNumberChange(n){var r;null===(r=this.changePhoneNumberForm.get("phoneNumber"))||void 0===r||r.patchValue(n)}onChangePhoneNumber(){if(this.changePhoneNumberForm.invalid)return;const n=this.changePhoneNumberForm.getRawValue();console.log("onChangePhoneNumber",n),this.authService.bindMobile({smsCode:n.verificationCode,mobileArea:n.countryCode?n.countryCode:"+86",mobile:n.phoneNumber}).subscribe(r=>(0,M.mG)(this,void 0,void 0,function*(){0===r.code?(yield this.userService.updateUserInfo(),this.toast.toastSuccess("\u4fee\u6539\u6210\u529f"),this.changePhoneNumberForm.reset({countryCode:"+86"}),this.handleDismiss()):this.toast.toastError(r.message)}))}onSendVerificationCode(){const n=this.changePhoneNumberForm.getRawValue();console.log("onSendVerificationCode",n),this.authService.sendSmsCode({type:f.eo.ModifyTheMobilePhone,mobileArea:n.countryCode?n.countryCode:"+86",mobile:n.phoneNumber}).subscribe(r=>{(0,v.d8)(f._5,(Date.now()+6e4).toString()),0===r.code?(this.smsTimeRemaining=60,this.startTimeInterval(),this.toast.toastSuccess("\u9a8c\u8bc1\u7801\u5df2\u53d1\u9001")):this.toast.toastError(r.message)})}startTimeInterval(){this.timeInterval=setInterval(()=>{this.smsTimeRemaining-=1,this.smsTimeRemaining<1&&clearInterval(this.timeInterval)},1e3)}}return m.\u0275fac=function(n){return new(n||m)(t.Y36(a.qu),t.Y36(e.e),t.Y36(E.K))},m.\u0275cmp=t.Xpm({type:m,selectors:[["app-edit-phone-modal"]],standalone:!0,features:[t.qOj,t.jDz],decls:2,vars:1,consts:[[1,"theme-modal",3,"isOpen","didDismiss"],[1,"flex","flex-col","p-2","h-full",3,"formGroup"],[1,"modal-header","flex","flex-col","items-center"],[1,"relative","w-full"],[1,"text-2xl","sm:text-3xl","text-text-strong","font-medium","text-left","sm:text-center","ml-1","sm:ml-0","sm:my-2"],["name","close-outline",1,"absolute","right-0","top-0","w-8","h-8","sm:w-10","sm:h-10","m-1","cursor-pointer",3,"click"],[1,"modal-content","px-1","sm:px-3"],[3,"onSelectPhoneCountry","onPhoneNumberChange"],[1,"sms-field","flex","w-full"],[1,"flex","flex-auto","items-center","bg-bg-input","rounded-l-lg","border","border-border-input","text-text-strong","text-xl"],["formControlName","verificationCode","required","",1,"sms-code",3,"placeholder"],["appRippleEffect","",1,"btn-blue","sms-btn","border","border-border-input","rounded-r-lg","font-medium","text-text-strong","p-3","whitespace-nowrap",3,"disabled","click"],[1,"modal-footer","flex","justify-between","px-1","sm:px-3"],["appRippleEffect","",1,"btn-medium","text-text-strong",3,"click"],["appRippleEffect","",1,"btn-blue","font-medium",3,"disabled","click"]],template:function(n,r){1&n&&(t.TgZ(0,"ion-modal",0),t.NdJ("didDismiss",function(){return r.handleDismiss()}),t.YNc(1,s,23,18,"ng-template"),t.qZA()),2&n&&t.Q6J("isOpen",r.isOpen)},dependencies:[x.ez,a.u5,a._Y,a.JJ,a.JL,a.Q7,a.UX,a.sg,a.u,h.aw,h.X$,c.Pc,c.gu,c.pK,c.ki,c.j9,u.T,_.b,p.R],styles:["ion-modal[_ngcontent-%COMP%]{--width: 480px;--height: auto;--overflow: visible}ion-modal[_ngcontent-%COMP%]     .ion-page{overflow:visible}ion-input[_ngcontent-%COMP%]{--placeholder-color: var(--input-placeholder);--placeholder-font-weight: 500;--padding-top: 4px;--padding-bottom: 4px}ion-input.sms-code[_ngcontent-%COMP%]{--padding-start: 10px}.sms-field[_ngcontent-%COMP%]{margin-top:1.2rem}@media (min-width: 640px){.sms-field[_ngcontent-%COMP%]{margin-top:1.7rem}}.sms-btn[_ngcontent-%COMP%]{font-size:1.16rem}.modal-header[_ngcontent-%COMP%]{margin-bottom:.5rem}@media (min-width: 640px){.modal-header[_ngcontent-%COMP%]{margin-bottom:.85rem}}.modal-content[_ngcontent-%COMP%]{margin-bottom:1.1rem}@media (min-width: 640px){.modal-content[_ngcontent-%COMP%]{margin-bottom:1.6rem}}.modal-footer[_ngcontent-%COMP%]{margin-bottom:.35rem}@media (min-width: 640px){.modal-footer[_ngcontent-%COMP%]{margin-bottom:.85rem}}.modal-footer[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{height:3rem;width:8rem;border-radius:.375rem;border-width:1px;border-style:solid;font-size:1.25rem;line-height:1.75rem}@media (min-width: 640px){.modal-footer[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{height:3.5rem;width:11rem;font-size:1.5rem;line-height:2rem}}"]}),m})()}}]);