"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[4392],{4725:(he,T,i)=>{i.r(T),i.d(T,{AuthModule:()=>fe});var h=i(6895),s=i(4006),l=i(8008),v=i(3416),Q=i(8854),C=i(1169),d=i(3709),V=i(1597),N=i(9300),x=i(7154),e=i(4650);const Y=function(r){return{register:r}},z=function(r){return{"hidden sm:block":r}};let E=(()=>{class r extends x.H{constructor(o){super(),this.changeDetectorRef=o,this.bgNum=1,this.isMobile=!1,this.isRegisterPage=!1,this.isMobile=window.innerWidth<992,this.router.events.pipe((0,N.h)(t=>t instanceof d.m2)).subscribe(t=>{this.isRegisterPage="/auth/register"===t.url.slice(0,14)})}onResize(){this.isMobile=window.innerWidth<992}ngOnInit(){this.bgNum=this.getRandomInt(1,7)}getRandomInt(o,t){return o=Math.ceil(o),t=Math.floor(t),Math.floor(Math.random()*(t-o+1))+o}prepareRoute(o){return o&&o.activatedRouteData&&o.activatedRouteData.animation?(setTimeout(()=>{this.changeDetectorRef.detectChanges()},0),`${o.activatedRouteData.animation}-${this.isMobile?"m":"d"}`):""}}return r.\u0275fac=function(o){return new(o||r)(e.Y36(e.sBO))},r.\u0275cmp=e.Xpm({type:r,selectors:[["app-auth"]],hostBindings:function(o,t){1&o&&e.NdJ("resize",function(){return t.onResize()},!1,e.Jf7)},features:[e.qOj],decls:8,vars:9,consts:[[1,"auth-page",3,"ngClass","fullscreen"],[1,"auth-wrapper","w-full","min-h-screen","xl:w-10/12","px-5","m-auto","2md:h-full","flex","flex-col","2md:flex-row","items-center","2md:justify-between","overflow-hidden"],[1,"auth-logo-wrapper","w-full","2md:w-1/2","my-10","2md:my-0","mx-auto",3,"ngClass"],["src","assets/logo-light.png","alt","",1,"m-auto","light-element",3,"routerLink"],["src","assets/logo-dark.png","alt","",1,"m-auto","dark-element",3,"routerLink"],[1,"auth-container","relative","min-w-full","sm:min-w-[450px]"],["outlet","outlet"]],template:function(o,t){1&o&&(e.TgZ(0,"ion-content",0)(1,"div",1)(2,"div",2),e._UZ(3,"img",3)(4,"img",4),e.qZA(),e.TgZ(5,"div",5),e._UZ(6,"router-outlet",null,6),e.qZA()()()),2&o&&(e.Q6J("ngClass",e.VKq(5,Y,t.isRegisterPage))("fullscreen",!0),e.xp6(2),e.Q6J("ngClass",e.VKq(7,z,t.isRegisterPage)),e.xp6(1),e.Q6J("routerLink","/"),e.xp6(1),e.Q6J("routerLink","/"))},dependencies:[h.mk,d.lC,d.rH,l.W2,l.YI],styles:[".auth-container.ng-animating[_ngcontent-%COMP%]{position:absolute}.auth-logo-wrapper[_ngcontent-%COMP%]{max-width:75%}@media (min-width: 375px){.auth-logo-wrapper[_ngcontent-%COMP%]{max-width:60%}}@media (min-width: 640px){.auth-logo-wrapper[_ngcontent-%COMP%]{max-width:616px}}  .light-mode ion-content.auth-page{--background: url(/assets/login-bg/login-bg-new-light-min.png) top center / cover no-repeat;position:relative}  .light-mode ion-content.auth-page .auth-logo-wrapper img{filter:drop-shadow(0px 0px 15px #ffffff)}@media (min-width: 640px){  .light-mode ion-content.auth-page{--background: url(/assets/login-bg/login-bg-new-light-min.png) top left / cover no-repeat}  .light-mode ion-content.auth-page .auth-logo-wrapper img{filter:none}}  .dark-mode ion-content.auth-page{--background: url(/assets/login-bg/login-bg-new-dark-min.png) top left / cover no-repeat}  input:-webkit-autofill,   input:-webkit-autofill:hover,   input:-webkit-autofill:focus,   textarea:-webkit-autofill,   textarea:-webkit-autofill:hover,   textarea:-webkit-autofill:focus,   select:-webkit-autofill,   select:-webkit-autofill:hover,   select:-webkit-autofill:focus{border:0;-webkit-text-fill-color:var(--text-input);-webkit-box-shadow:0 0 0px 1000px transparent inset;-webkit-transition:background-color 50000s ease-in-out 0s;transition:background-color 50000s ease-in-out 0s}"],data:{animation:[V.DY]}}),r})();var Z=i(655),w=i(8764),y=i(7312),B=i(5244),P=i(9769),H=i.n(P),k=i(8505),K=i(9808),S=i(5939),D=i(4107),I=i(6540),L=i(7139),R=i(3284),q=i(6065),U=i(8222);function G(r,n){if(1&r&&(e.TgZ(0,"div",36),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&r){const o=e.oxw();let t;e.xp6(1),e.hij(" ",e.lcZ(2,1,null==(t=o.form.get("username"))||null==t.errors?null:t.errors.label)," ")}}function X(r,n){if(1&r&&(e.TgZ(0,"div",36),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&r){const o=e.oxw();let t;e.xp6(1),e.hij(" ",e.lcZ(2,1,null==(t=o.form.get("password"))||null==t.errors?null:t.errors.label)," ")}}function $(r,n){if(1&r&&(e.TgZ(0,"div",36),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&r){const o=e.oxw();let t;e.xp6(1),e.hij(" ",e.lcZ(2,1,null==(t=o.form.get("confirmPassword"))||null==t.errors?null:t.errors.label)," ")}}function W(r,n){if(1&r&&(e.TgZ(0,"div",36),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&r){const o=e.oxw();let t;e.xp6(1),e.hij(" ",e.lcZ(2,1,null==(t=o.form.get("email"))||null==t.errors?null:t.errors.label)," ")}}function ee(r,n){1&r&&(e.TgZ(0,"div",36),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&r&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"verification-code-required")," "))}function te(r,n){1&r&&e._UZ(0,"app-loading-spinner",37)}const oe=function(r){return{failed:r}},A=function(r){return{"!border-red-1":r}},re=function(r){return{"has-inviter":r}};let ie=(()=>{class r extends x.H{constructor(o,t,a,p,c,m,u,f){super(),this.fb=o,this.userService=t,this.referralService=a,this.cdr=p,this.activatedRoute=c,this.route=m,this.authService=u,this.loadingController=f,this.type="1",this.smsTimeRemaining=0,this.registerFailed=!1,this.isSubmitted=!1,this.isLoading=!1,this.confirmationValidator=g=>g.value?Object.is(g.value,this.form.controls.password.value)?{}:{error:!0,label:"confirm-password-validation-dismatch"}:{error:!0,label:"confirm-password-validation-required"}}ngOnInit(){this.initForm(),this.getVerifyCode();const o=this.route.snapshot.queryParams;console.log("queryParams",o),this.router.navigate(["/auth/login"],{queryParams:Object.assign(Object.assign({},o),{method:"register"})})}validate(){this.form.valid?this.submit():Object.values(this.form.controls).forEach(o=>{o.invalid&&(o.markAsDirty(),o.updateValueAndValidity({onlySelf:!0}))})}getVerifyCode(){this.verifyCode=null}onSelectPhoneCountry(o){var t;o&&(null===(t=this.form.get("mobileArea"))||void 0===t||t.patchValue(o))}onPhoneNumberChange(o){var t;null===(t=this.form.get("mobile"))||void 0===t||t.patchValue(o)}getSmsCode(){const{mobile:o,mobileArea:t}=this.form.value;this.authService.sendSmsCode({type:y.eo.Register,mobileArea:t,mobile:o.toString()}).subscribe({next:a=>{0===a.code?(this.toast.toastSuccess("\u53d1\u9001\u6210\u529f"),B.Z.set(y._h,(Date.now()+6e4).toString()),this.smsTimeRemaining=60,this.startTimeInterval()):this.toast.toastError(a.message)},error:a=>{this.toast.toastError("\u624b\u673a\u53f7\u5df2\u5b58\u5728"),console.error(a)}}),this.type="2"}startTimeInterval(){this.timeInterval=setInterval(()=>{this.smsTimeRemaining-=1,this.smsTimeRemaining<1&&clearInterval(this.timeInterval)},1e3)}getEmailCode(){if(!this.form.controls.email.valid)return this.form.controls.email.markAsDirty(),void this.form.controls.email.updateValueAndValidity({onlySelf:!0});this.authService.SendEmailVerifyCodeParam({email:this.form.value.email,type:"register"}).subscribe(o=>{0!==o.code?(this.toast.toastError(o.message),this.smsTimeRemaining=60):this.toast.toastSuccess("\u90ae\u4ef6\u5df2\u53d1\u9001")}),this.type="1"}submit(){return(0,Z.mG)(this,void 0,void 0,function*(){const o=Object.assign({},this.form.value);this.isLoading=this.isSubmitted=!0,delete o.confirmPassword,console.log(o),yield(yield this.loadingController.create()).present(),this.authService.registerV2(Object.assign(Object.assign({inviteCode:this.inviterId},o),{registerType:this.type,account:o.username,areaCode:o.mobileArea,mobile:o.mobile?o.mobile.toString():null,email:o.email?o.email:null,password:H()(o.password).toString()})).pipe((0,k.b)(()=>{this.isLoading=!1})).subscribe(a=>{if(0!==a.code)return this.toast.toastError(a.message),void this.registerHasFailed();this.toast.toastSuccess("\u6ce8\u518c\u6210\u529f"),this.userService.toggleLoginModal(!1),this.login({body:a,headers:{}})},a=>{console.log(a),this.toast.toastError(a.message),this.getVerifyCode()}).add(()=>{this.loadingController.dismiss(),this.userService.toggleLoginModal(!1)})})}login(o){o.body.data?(this.userService.setToken(o.body.data.token),setTimeout(()=>(0,Z.mG)(this,void 0,void 0,function*(){const t=yield(0,K.n)(this.authService.getUserLoginInfo());console.log("res.data.userInfo",t),yield this.userService.setUserInfo(t.data),yield this.userService.updateUserInfo();const a=this.route.snapshot.queryParamMap.get("back")||"/";this.router.navigateByUrl(decodeURIComponent(a)),this.router.navigateByUrl("/dashboard")}),0)):this.toast.toastError(o.body.message)}initForm(){var o;console.log("initForm"),this.inviterId=null,this.referralService.inviterId&&(this.inviterId=this.referralService.inviterId),this.form=this.fb.group({username:[null,[s.kI.required]],password:[null,[w.d.password]],confirmPassword:[null,[s.kI.required,this.confirmationValidator]],email:[null,w.d.email],verifyCode:[null,[s.kI.required]],inviteCode:[this.inviterId],isProfessionalTrader:[!1,[s.kI.required]]}),console.log("initForm",this.form),this.inviterId&&(null===(o=this.form.get("inviteCode"))||void 0===o||o.disable())}registerHasFailed(){this.registerFailed=!0,setTimeout(()=>{this.registerFailed=!1},800)}}return r.\u0275fac=function(o){return new(o||r)(e.Y36(s.qu),e.Y36(S.K),e.Y36(D.C),e.Y36(e.sBO),e.Y36(d.gz),e.Y36(d.gz),e.Y36(I.e),e.Y36(l.HT))},r.\u0275cmp=e.Xpm({type:r,selectors:[["app-register"]],features:[e.qOj],decls:60,vars:60,consts:[[1,"auth-box","register-component","rounded-2xl","border-main-border","border-2","bg-main-bg","px-2","py-8","font-medium","mt-8","sm:mt-0",3,"ngClass"],[1,"flex","items-center","mb-8","pr-2","sm:pr-4"],["routerLink","/auth/login",1,"cursor-pointer","w-8","h-8","mr-1"],["name","chevron-back-outline",1,"w-8","h-8"],[1,"active","tab","relative","text-lg","cursor-pointer","rounded-t","py-3","font-medium","whitespace-nowrap","flex-auto","text-center","mr-1"],[1,"hidden","sm:flex","items-center","ml-4"],[1,"w-full","px-2","sm:px-6",3,"formGroup"],[1,"form-field"],[1,"rounded-md","border-border-input","border","flex","items-center","bg-bg-input","px-2",3,"ngClass"],[1,"icon-person","text-text-strong","text-xl"],["formControlName","username",3,"placeholder"],["class","mt-1 text-sm text-red-1",4,"ngIf"],["formControlName","password","customInvalidClass","border-red-1",3,"placeholder","isInvalid"],["formControlName","confirmPassword","customInvalidClass","border-red-1",3,"placeholder","isInvalid"],[1,"icon-letter","text-text-strong","text-xl"],["formControlName","email",1,"",3,"placeholder"],[1,"sms-field","flex","w-full","gap-x-2"],[1,"flex","flex-auto","items-center","bg-bg-input","rounded-lg","border","border-border-input","text-text-strong",3,"ngClass"],["formControlName","verifyCode",1,"sms-code",3,"placeholder"],["appRippleEffect","",1,"btn-blue","sms-btn","border","border-border-input","rounded-lg","font-medium","text-text-strong","px-3","whitespace-nowrap",3,"disabled","click"],[1,"flex","flex-col"],[1,"icon-letter","text-xl"],[1,"text-sm","leading-none"],[1,"form-field","inviter-input","rounded-md","border-border-input","border","flex","items-center","bg-bg-input","px-2",3,"ngClass"],[1,"icon-chaine","text-text-strong","text-xl"],["formControlName","inviteCode",3,"placeholder"],["for","professionalTrader",1,"flex","items-center","mb-5","cursor-pointer"],["name","professionalTrader","mode","md","formControlName","isProfessionalTrader",1,"m-0","mr-1.5"],[1,"text-text-strong"],["type","submit","appRippleEffect","",1,"btn-blue","font-medium","border-solid","border-2","text-center","block","w-full","rounded-lg","py-3","uppercase","text-2xl",3,"click"],["class","text-white absolute top-1/2 left-1/2 transfrom -translate-x-1/2 -translate-y-1/2","size","30px","thick","3px",4,"ngIf"],[1,"flex","items-center","justify-between","sm:justify-center","my-5"],[1,"flex","items-center","justify-center","bg-main-bg","p-1.5","rounded-md"],["interface","modal",3,"showText"],["name","chevron-forward-outline"],[1,"mr-2","sm:hidden"],[1,"mt-1","text-sm","text-red-1"],["size","30px","thick","3px",1,"text-white","absolute","top-1/2","left-1/2","transfrom","-translate-x-1/2","-translate-y-1/2"]],template:function(o,t){if(1&o&&(e.TgZ(0,"div",0)(1,"div",1)(2,"a",2),e._UZ(3,"ion-icon",3),e.qZA(),e.TgZ(4,"div",4),e._uU(5),e.ALo(6,"translate"),e.qZA(),e._UZ(7,"app-theme-toggle",5),e.qZA(),e.TgZ(8,"form",6)(9,"div",7)(10,"div",8),e._UZ(11,"i",9)(12,"ion-input",10),e.ALo(13,"translate"),e.qZA(),e.YNc(14,G,3,3,"div",11),e.qZA(),e.TgZ(15,"div",7),e._UZ(16,"app-password-field",12),e.ALo(17,"translate"),e.YNc(18,X,3,3,"div",11),e.qZA(),e.TgZ(19,"div",7),e._UZ(20,"app-password-field",13),e.ALo(21,"translate"),e.YNc(22,$,3,3,"div",11),e.qZA(),e.TgZ(23,"div",7)(24,"div",8),e._UZ(25,"i",14)(26,"ion-input",15),e.ALo(27,"translate"),e.qZA(),e.YNc(28,W,3,3,"div",11),e.qZA(),e.TgZ(29,"div",7)(30,"div",16)(31,"div",17),e._UZ(32,"ion-input",18),e.ALo(33,"translate"),e.qZA(),e.TgZ(34,"button",19),e.NdJ("click",function(){return t.getEmailCode()}),e.TgZ(35,"div",20),e._UZ(36,"i",21),e.TgZ(37,"span",22),e._uU(38),e.ALo(39,"translate"),e.qZA()()()(),e.YNc(40,ee,3,3,"div",11),e.qZA(),e.TgZ(41,"div",23),e._UZ(42,"i",24)(43,"ion-input",25),e.ALo(44,"translate"),e.qZA(),e.TgZ(45,"label",26),e._UZ(46,"ion-checkbox",27),e.TgZ(47,"ion-label",28),e._uU(48),e.ALo(49,"translate"),e.qZA()(),e.TgZ(50,"button",29),e.NdJ("click",function(){return t.submit()}),e.TgZ(51,"span"),e._uU(52),e.ALo(53,"translate"),e.qZA(),e.YNc(54,te,1,0,"app-loading-spinner",30),e.qZA()()(),e.TgZ(55,"div",31)(56,"div",32),e._UZ(57,"app-language-dropdown",33)(58,"ion-icon",34),e.qZA(),e._UZ(59,"app-theme-toggle",35),e.qZA()),2&o){let a,p,c,m,u,f,g,b,M,_,F;e.Q6J("ngClass",e.VKq(50,oe,t.registerFailed)),e.xp6(5),e.hij(" ",e.lcZ(6,30,"register")," "),e.xp6(3),e.Q6J("formGroup",t.form),e.xp6(2),e.Q6J("ngClass",e.VKq(52,A,(null==(a=t.form.get("username"))?null:a.errors)&&t.isSubmitted)),e.xp6(2),e.s9C("placeholder",e.lcZ(13,32,"username")),e.xp6(2),e.Q6J("ngIf",(null==(p=t.form.get("username"))?null:p.errors)&&t.isSubmitted),e.xp6(2),e.s9C("placeholder",e.lcZ(17,34,"password")),e.Q6J("isInvalid",(null==(c=t.form.get("password"))?null:c.errors)&&t.isSubmitted),e.xp6(2),e.Q6J("ngIf",(null==(m=t.form.get("password"))?null:m.errors)&&t.isSubmitted),e.xp6(2),e.s9C("placeholder",e.lcZ(21,36,"confirm-password")),e.Q6J("isInvalid",(null==(u=t.form.get("confirmPassword"))?null:u.errors)&&t.isSubmitted),e.xp6(2),e.Q6J("ngIf",(null==(f=t.form.get("confirmPassword"))?null:f.errors)&&t.isSubmitted),e.xp6(2),e.Q6J("ngClass",e.VKq(54,A,(null==(g=t.form.get("email"))?null:g.errors)&&t.isSubmitted)),e.xp6(2),e.s9C("placeholder",e.lcZ(27,38,"email")),e.xp6(2),e.Q6J("ngIf",(null==(b=t.form.get("email"))?null:b.errors)&&t.isSubmitted),e.xp6(3),e.Q6J("ngClass",e.VKq(56,A,(null==(M=t.form.get("verifyCode"))?null:M.errors)&&t.isSubmitted)),e.xp6(1),e.Q6J("placeholder",e.lcZ(33,40,"verification-code")),e.xp6(2),e.Q6J("disabled",!0===(null==(_=t.form.get("email"))||null==_.errors?null:_.errors.error)),e.xp6(4),e.hij(" ",e.lcZ(39,42,"email")," "),e.xp6(2),e.Q6J("ngIf",(null==(F=t.form.get("verifyCode"))?null:F.errors)&&t.isSubmitted),e.xp6(1),e.Q6J("ngClass",e.VKq(58,re,t.inviterId)),e.xp6(2),e.s9C("placeholder",e.lcZ(44,44,"fill-inviter")),e.xp6(5),e.hij(" ",e.lcZ(49,46,"professional-trader-question")," "),e.xp6(2),e.ekj("btn-disabled",t.form.invalid),e.xp6(1),e.ekj("invisible",t.isLoading),e.xp6(1),e.Oqu(e.lcZ(53,48,"register")),e.xp6(2),e.Q6J("ngIf",t.isLoading),e.xp6(3),e.Q6J("showText",!0)}},dependencies:[h.mk,h.O5,d.rH,l.nz,l.gu,l.pK,l.Q$,l.w,l.j9,l.Fo,s._Y,s.JJ,s.JL,s.sg,s.u,L.q,R.T,q.R,C.b,U.T,v.X$],styles:["[_nghost-%COMP%]{max-width:100%;margin-left:auto;margin-right:auto}ion-input[_ngcontent-%COMP%]{--padding-start: 8px;--padding-top: 11px;--padding-bottom: 11px;--placeholder-opacity: 1;--placeholder-color: var(--input-placeholder);--placeholder-weight: 500;font-size:1.1rem;line-height:24px;color:var(--text-strong)}ion-checkbox[_ngcontent-%COMP%]{--background: var(--main-bg);--border-color: var(--main-border)}.auth-box[_ngcontent-%COMP%]{max-width:100%;width:100%;box-shadow:0 0 10px 10px rgba(0,0,0,.3)}@media (min-width: 640px){.auth-box[_ngcontent-%COMP%]{width:450px;min-width:450px}}.auth-box.failed[_ngcontent-%COMP%]{animation:angry-shake .4s}.auth-box.failed[_ngcontent-%COMP%]   button[type=submit][_ngcontent-%COMP%]{background-color:var(--main-red);border-color:var(--main-red);color:#fff;opacity:1}.tab[_ngcontent-%COMP%]{font-size:1.35rem;line-height:1.75rem}.form-field[_ngcontent-%COMP%]{margin-bottom:1.1rem}@media (min-width: 640px){.form-field[_ngcontent-%COMP%]{margin-bottom:.75rem}}  .dark-mode app-auth .tab{border-bottom-width:2px;border-style:solid;border-color:transparent;color:var(--text-strong);background-color:#21213a}  .dark-mode app-auth .tab.active{background-color:#181f42;border-color:var(--main-blue)}  .dark-mode app-auth .tab-body{background-color:#232232}  .dark-mode app-auth .inviter-input.has-inviter{background-color:#302d4b}  .dark-mode app-auth .inviter-input.has-inviter ion-input{color:#7c78a1!important}  .dark-mode app-auth .inviter-input.has-inviter i{color:#7c78a1!important}  .dark-mode app-auth .inviter-input.has-inviter   input{opacity:1!important}  .light-mode app-auth .tab{border-bottom-width:2px;border-style:solid;border-color:transparent;color:var(--text-strong);background-color:#f0f0f0}  .light-mode app-auth .tab.active{border-color:var(--main-blue);color:var(--main-blue);background:#dee8f8}  .light-mode app-auth .tab.active app-globe-icon svg *{fill:#fff}  .light-mode app-auth .tab-body{background-color:#fff}"]}),r})();function ne(r,n){if(1&r&&(e.TgZ(0,"div",28),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&r){const o=e.oxw();let t;e.xp6(1),e.hij(" ",e.lcZ(2,1,null==(t=o.form.get("email"))||null==t.errors?null:t.errors.label)," ")}}function ae(r,n){1&r&&(e.TgZ(0,"div",28),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&r&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"verification-code-required")," "))}function se(r,n){if(1&r&&(e.TgZ(0,"div",28),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&r){const o=e.oxw();let t;e.xp6(1),e.hij(" ",e.lcZ(2,1,null==(t=o.form.get("newPassword"))||null==t.errors?null:t.errors.label)," ")}}function le(r,n){if(1&r&&(e.TgZ(0,"div",28),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&r){const o=e.oxw();let t;e.xp6(1),e.hij(" ",e.lcZ(2,1,null==(t=o.form.get("confirmPassword"))||null==t.errors?null:t.errors.label)," ")}}function de(r,n){1&r&&e._UZ(0,"app-loading-spinner",29)}const me=function(r){return{failed:r}},J=function(r){return{"!border-red-1":r}};let ue=(()=>{class r extends x.H{constructor(o,t,a,p,c,m){super(),this.fb=o,this.userService=t,this.cdr=a,this.activatedRoute=p,this.authService=c,this.i18n=m,this.type="register",this.smsTimeRemaining=0,this.forgotPasswordFailed=!1,this.isSubmitted=!1,this.isLoading=!1,this.confirmationValidator=u=>u.value?Object.is(u.value,this.form.controls.newPassword.value)?{}:{error:!0,label:"confirm-password-validation-dismatch"}:{error:!0,label:"confirm-password-validation-required"}}ngOnInit(){this.initForm()}validate(){this.form.valid?this.submit():Object.values(this.form.controls).forEach(o=>{o.invalid&&(console.log("control",o.errors),o.markAsDirty(),o.updateValueAndValidity({onlySelf:!0}))})}onSelectPhoneCountry(o){var t;o&&(null===(t=this.form.get("mobileArea"))||void 0===t||t.patchValue(o))}onPhoneNumberChange(o){var t;null===(t=this.form.get("mobile"))||void 0===t||t.patchValue(o)}getSmsCode(){const o=this.form.getRawValue();this.authService.sendSmsCode({type:y.eo.ResetPassword,mobileArea:o.countryCode?o.countryCode:"+86",mobile:o.mobile}).pipe().subscribe(t=>{0===t.code?this.toast.toastSuccess(this.i18n.instant("verification-code-sent")):this.toast.toastError(t.message)})}startTimeInterval(){this.timeInterval=setInterval(()=>{this.smsTimeRemaining-=1,this.smsTimeRemaining<1&&clearInterval(this.timeInterval)},1e3)}getEmailCode(){if(!this.form.controls.email.valid)return this.form.controls.email.markAsDirty(),void this.form.controls.email.updateValueAndValidity({onlySelf:!0});this.authService.SendEmailVerifyCodeParam({email:this.form.value.email,type:"resetPassword"}).subscribe(o=>{1001006!==o.code?(this.toast.toastSuccess(this.i18n.instant("message-sent-tips")),this.smsTimeRemaining=60,this.startTimeInterval()):this.toast.toastError(this.i18n.instant("email-already-exists"))}),this.type="1"}submit(){const o=Object.assign(Object.assign({},this.form.value),{type:this.type});this.isSubmitted=!0,console.log(o),this.form.invalid?this.forgotPasswordHasFailed():(console.log(o),this.isLoading=!0,this.authService.forgetPassword({codeType:"email_code",code:o.verifyCode,email:o.email,newPassword:P(o.newPassword).toString()}).pipe((0,k.b)(()=>{this.isLoading=!1})).subscribe(t=>(0,Z.mG)(this,void 0,void 0,function*(){0===t.code?(yield this.userService.updateUserInfo(),this.toast.toastSuccess(this.i18n.instant("successfully-modified")),this.router.navigateByUrl("/auth/login")):this.toast.toastError(t.message)})))}initForm(){this.form=this.fb.group({mobileArea:["+86"],verifyCode:[null,[s.kI.required]],newPassword:[null,[w.d.password]],confirmPassword:[null,[s.kI.required,this.confirmationValidator]],email:[null,[s.kI.required,w.d.email]]})}forgotPasswordHasFailed(){this.forgotPasswordFailed=!0,setTimeout(()=>{this.forgotPasswordFailed=!1},800)}}return r.\u0275fac=function(o){return new(o||r)(e.Y36(s.qu),e.Y36(S.K),e.Y36(e.sBO),e.Y36(d.gz),e.Y36(I.e),e.Y36(v.sK))},r.\u0275cmp=e.Xpm({type:r,selectors:[["app-forgot-password"]],features:[e.qOj],decls:45,vars:42,consts:[[1,"auth-box","register-component","rounded-2xl","border-main-border","border-2","bg-main-bg","px-2","py-8","font-medium",3,"ngClass"],[1,"flex","items-center","mb-8","pr-2","sm:pr-4"],["routerLink","/auth/login",1,"cursor-pointer","w-8","h-8","mr-1"],["name","chevron-back-outline",1,"w-8","h-8"],[1,"active","tab","cursor-pointer","rounded-t","py-3","font-medium","whitespace-nowrap","flex-auto","text-center","mr-1"],[1,"hidden","sm:flex","items-center","ml-4"],[1,"w-full","px-2","sm:px-6",3,"formGroup"],[1,"my-3"],[1,"rounded-md","border-border-input","border","flex","items-center","bg-bg-input","px-2",3,"ngClass"],[1,"icon-letter","text-text-strong","text-xl"],["formControlName","email",1,"",3,"placeholder"],["class","mt-1 text-sm text-red-1",4,"ngIf"],[1,"sms-field","flex","w-full","gap-x-2"],[1,"flex","flex-auto","items-center","bg-bg-input","rounded-lg","border","border-border-input","text-text-strong",3,"ngClass"],["formControlName","verifyCode",1,"sms-code",3,"placeholder"],[1,"btn-blue","sms-btn","border","border-border-input","rounded-lg","font-medium","text-text-strong","py-1","px-3","whitespace-nowrap",3,"disabled","click"],[1,"flex","flex-col"],[1,"icon-letter","text-xl"],[1,"text-sm"],["formControlName","newPassword",1,"w-full",3,"placeholder"],["formControlName","confirmPassword",1,"w-full",3,"placeholder","isInvalid"],["type","submit","appRippleEffect","",1,"btn-blue","font-medium","border-solid","border-2","text-center","block","w-full","rounded-lg","py-3","uppercase","text-2xl",3,"disabled","click"],["class","text-white absolute top-1/2 left-1/2 transfrom -translate-x-1/2 -translate-y-1/2","size","30px","thick","3px",4,"ngIf"],[1,"flex","items-center","justify-between","sm:justify-center","my-5"],[1,"flex","items-center","justify-center","bg-main-bg","p-1.5","rounded-md"],["interface","modal",3,"showText"],["name","chevron-forward-outline"],[1,"mr-2","sm:hidden"],[1,"mt-1","text-sm","text-red-1"],["size","30px","thick","3px",1,"text-white","absolute","top-1/2","left-1/2","transfrom","-translate-x-1/2","-translate-y-1/2"]],template:function(o,t){if(1&o&&(e.TgZ(0,"div",0)(1,"div",1)(2,"a",2),e._UZ(3,"ion-icon",3),e.qZA(),e.TgZ(4,"div",4),e._uU(5),e.ALo(6,"translate"),e.qZA(),e._UZ(7,"app-theme-toggle",5),e.qZA(),e.TgZ(8,"form",6)(9,"div",7)(10,"div",8),e._UZ(11,"i",9)(12,"ion-input",10),e.ALo(13,"translate"),e.qZA(),e.YNc(14,ne,3,3,"div",11),e.qZA(),e.TgZ(15,"div",7)(16,"div",12)(17,"div",13),e._UZ(18,"ion-input",14),e.ALo(19,"translate"),e.qZA(),e.TgZ(20,"button",15),e.NdJ("click",function(){return t.getEmailCode()}),e.TgZ(21,"div",16),e._UZ(22,"i",17),e.TgZ(23,"span",18),e._uU(24),e.ALo(25,"translate"),e.qZA()()()(),e.YNc(26,ae,3,3,"div",11),e.qZA(),e.TgZ(27,"div",7),e._UZ(28,"app-password-field",19),e.ALo(29,"translate"),e.YNc(30,se,3,3,"div",11),e.qZA(),e.TgZ(31,"div",7),e._UZ(32,"app-password-field",20),e.ALo(33,"translate"),e.YNc(34,le,3,3,"div",11),e.qZA(),e.TgZ(35,"button",21),e.NdJ("click",function(){return t.submit()}),e.TgZ(36,"span"),e._uU(37),e.ALo(38,"translate"),e.qZA(),e.YNc(39,de,1,0,"app-loading-spinner",22),e.qZA()()(),e.TgZ(40,"div",23)(41,"div",24),e._UZ(42,"app-language-dropdown",25)(43,"ion-icon",26),e.qZA(),e._UZ(44,"app-theme-toggle",27),e.qZA()),2&o){let a,p,c,m,u,f,g,b;e.Q6J("ngClass",e.VKq(36,me,t.forgotPasswordFailed)),e.xp6(5),e.hij(" ",e.lcZ(6,22,"forgot-password")," "),e.xp6(3),e.Q6J("formGroup",t.form),e.xp6(2),e.Q6J("ngClass",e.VKq(38,J,(null==(a=t.form.get("email"))?null:a.errors)&&t.isSubmitted)),e.xp6(2),e.s9C("placeholder",e.lcZ(13,24,"email")),e.xp6(2),e.Q6J("ngIf",(null==(p=t.form.get("email"))?null:p.errors)&&t.isSubmitted),e.xp6(3),e.Q6J("ngClass",e.VKq(40,J,(null==(c=t.form.get("verifyCode"))?null:c.errors)&&t.isSubmitted)),e.xp6(1),e.Q6J("placeholder",e.lcZ(19,26,"verification-code")),e.xp6(2),e.Q6J("disabled",!0===(null==(m=t.form.get("email"))||null==m.errors?null:m.errors.error)),e.xp6(4),e.hij(" ",e.lcZ(25,28,"email")," "),e.xp6(2),e.Q6J("ngIf",(null==(u=t.form.get("verifyCode"))?null:u.errors)&&t.isSubmitted),e.xp6(2),e.s9C("placeholder",e.lcZ(29,30,"new-password")),e.xp6(2),e.Q6J("ngIf",(null==(f=t.form.get("newPassword"))?null:f.errors)&&t.isSubmitted),e.xp6(2),e.s9C("placeholder",e.lcZ(33,32,"confirm-password")),e.Q6J("isInvalid",(null==(g=t.form.get("confirmPassword"))?null:g.errors)&&t.isSubmitted),e.xp6(2),e.Q6J("ngIf",(null==(b=t.form.get("confirmPassword"))?null:b.errors)&&t.isSubmitted),e.xp6(1),e.Q6J("disabled",t.form.invalid),e.xp6(1),e.ekj("invisible",t.isLoading),e.xp6(1),e.Oqu(e.lcZ(38,34,"submit")),e.xp6(2),e.Q6J("ngIf",t.isLoading),e.xp6(3),e.Q6J("showText",!0)}},dependencies:[h.mk,h.O5,d.rH,l.gu,l.pK,l.j9,l.Fo,s._Y,s.JJ,s.JL,s.sg,s.u,L.q,R.T,q.R,C.b,U.T,v.X$],styles:["[_nghost-%COMP%]{max-width:100%;margin-left:auto;margin-right:auto}ion-input[_ngcontent-%COMP%]{--padding-start: 8px;--padding-top: 11px;--padding-bottom: 11px;--placeholder-opacity: 1;--placeholder-color: var(--input-placeholder);--placeholder-weight: 500;font-size:1.1rem;line-height:24px;color:var(--text-strong)}ion-checkbox[_ngcontent-%COMP%]{--background: var(--main-bg);--border-color: var(--main-border)}.auth-box[_ngcontent-%COMP%]{max-width:100%;width:100%;box-shadow:0 0 10px 10px rgba(0,0,0,.3)}@media (min-width: 640px){.auth-box[_ngcontent-%COMP%]{width:450px;min-width:450px}}.auth-box.failed[_ngcontent-%COMP%]{animation:angry-shake .4s}.auth-box.failed[_ngcontent-%COMP%]   button[type=submit][_ngcontent-%COMP%]{background-color:var(--main-red);border-color:var(--main-red);color:#fff;opacity:1}.tab[_ngcontent-%COMP%]{font-size:1.35rem;line-height:1.75rem}  .dark-mode app-auth .tab{border-bottom-width:2px;border-style:solid;border-color:transparent;color:var(--text-strong);background-color:#21213a}  .dark-mode app-auth .tab.active{background-color:#181f42;border-color:var(--main-blue)}  .dark-mode app-auth .tab-body{background-color:#232232}  .dark-mode app-auth .inviter-input.has-inviter{background-color:#302d4b}  .dark-mode app-auth .inviter-input.has-inviter ion-input{color:#7c78a1!important}  .dark-mode app-auth .inviter-input.has-inviter i{color:#7c78a1!important}  .dark-mode app-auth .inviter-input.has-inviter   input{opacity:1!important}  .light-mode app-auth .tab{border-bottom-width:2px;border-style:solid;border-color:transparent;color:var(--text-strong);background-color:#f0f0f0}  .light-mode app-auth .tab.active{border-color:var(--main-blue);color:var(--main-blue);background:#dee8f8}  .light-mode app-auth .tab.active app-globe-icon svg *{fill:#fff}  .light-mode app-auth .tab-body{background-color:#fff}"]}),r})(),O=(()=>{class r extends x.H{}return r.\u0275fac=function(){let n;return function(t){return(n||(n=e.n5z(r)))(t||r)}}(),r.\u0275cmp=e.Xpm({type:r,selectors:[["app-login-page"]],features:[e.qOj],decls:1,vars:0,template:function(o,t){1&o&&e._UZ(0,"app-login")}}),r})();const pe=[{path:"",component:E,children:[{path:"login",component:O,data:{animation:"Login"}},{path:"register",component:ie,data:{animation:"Register"}},{path:"forgot-password",component:ue,data:{animation:"Register"}}]}];let ce=(()=>{class r{}return r.\u0275fac=function(o){return new(o||r)},r.\u0275mod=e.oAB({type:r}),r.\u0275inj=e.cJS({imports:[d.Bz.forChild(pe),d.Bz]}),r})();var j=i(8146),ge=i(9116);let fe=(()=>{class r{}return r.\u0275fac=function(o){return new(o||r)},r.\u0275mod=e.oAB({type:r}),r.\u0275inj=e.cJS({imports:[h.ez,j.G,ce,l.Pc,v.aw,s.u5,s.UX,Q.T,C.b,ge.Q]}),r})();e.B6R(O,[j.G],[])}}]);